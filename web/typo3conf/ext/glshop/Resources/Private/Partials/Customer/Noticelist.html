<f:comment><f:debug>{_all}</f:debug></f:comment>
{namespace glacryl=Glacryl\Glshop\ViewHelpers}

<div class="container">
	<div class="row">
		<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
			<f:if condition="{notices -> f:count()} > 0">
				<f:then>
					<div class="table-responsive">
						<table class="table" id="customer-notice-table">
							<thead>
								<tr>
									<th style="text-align: left; width:15%;">Kommission</th>
									<th style="text-align: left; width:36;">Artikel</th>
									<th style="text-align: center; width:12%;">Angelegt am</th>
									<th style="text-align: center; width:12%;">G&uuml;ltig bis</th>
									<th style="text-align: center; width:14%;">Aktion</th>
								</tr>
							</thead>
							<tbody>
							<f:for each="{notices}" as="kom">
								<tr class="odd">
									<td class="cell-bottom-border" style="text-align: left;">
										{kom.name}
									</td>
									<td class="cell-bottom-border" style="text-align: left;">
								<f:if condition="{kom.positionen -> f:count()} > 1" >
									<f:then>
										{kom.positionen -> f:count()} Positionen
									</f:then>
									<f:else>
										{kom.positionen -> f:count()} Position
									</f:else>
								</f:if>
								<span class="cart-materialInfo">
									<input type="hidden" class="notice-positions" value="{kom.ids}" />
									<a href="#" class="noticeItem-DetailBtn">Details</a>
								</span>
								<f:if condition="{noticeItem.article.material}" >
									<f:then>
										{noticeItem.article.materialConfig.width} x {noticeItem.article.materialConfig.height}
									</f:then>
									<f:else>
										&nbsp;
									</f:else>
								</f:if>
								<f:if condition="{noticeItem.article.material}" >
									<f:then>
										<f:for each="{material}" as="m">
											<f:if condition="{0:m.uid} == {0:noticeItem.article.material.uid}" >
												<f:for each="{m.materialoption}" as="v">
													<f:if condition="{0:v.uid} == {0:noticeItem.article.material.vid}" >
														<b>{m.name} {noticeItem.article.material.size} mm {v.name}</b>  <br />
														<span class="cart-materialInfo">
															inkl. Bearbeitung (siehe <a href="" class="noticeItem-DetailBtn">Details</a>)
														</span>
													</f:if>	
												</f:for>
											</f:if>
										</f:for>
									</f:then>
									<f:else>
										<f:if condition="{noticeItem.article.halter}" >
											<f:then>
												<f:for each="{halter}" as="h">
													<f:if condition="{0:noticeItem.article.halter.uid} == {0:h.uid}">
														<b>{h.name}</b><br />
														<span class="cart-materialInfo">
															<f:for each="{h.fixingoption}" as="v">
																<f:if condition="{0:noticeItem.article.halter.vid} == {0:v.uid}">
																	{v.name}
																</f:if>
															</f:for>
														</span>
													</f:if>
												</f:for>
											</f:then>
											<f:else>
												&nbsp;
											</f:else>
										</f:if>
									</f:else>
								</f:if>
								</td>
								<td class="cell-bottom-border" style="text-align: right;"> 
								<glacryl:date format="d.m.Y H:i" date="{kom.positionen.0.date}" />
								</td>
								<td class="cell-bottom-border" style="text-align: right;"> 
								<glacryl:date format="d.m.Y H:i" date="{kom.positionen.0.expire}" />
								</td>
								<td class="cell-bottom-border" style="text-align: right;">
									<input type="hidden" class="notice-positions" value="{kom.ids}" />
									<button  type="button" class="orderNoticeBtn glButtonFullWidth btn btn-default btn-lg btn-block"><span class="sprite-Warenkorb_activeBtn"><span>&nbsp;Bestellen</span></span></button>
								</td>
								</tr>
								<f:comment>Details - Einzelpositionen
								<tr class="odd cart-detail" style="display: none;">
									<td colspan="5" class="last">
										<div class="row">
											<div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
												<f:if condition="{noticeItem.pic}" >
													<p class="cart-detailImg">
													<f:if condition="{noticeItem.article.material}">
														<f:then>
															<img src="typo3conf/ext/glshop/Resources/Public/Zeichnungen/{noticeItem.pic}" />	
														</f:then>
														<f:else>
															<f:if condition="{noticeItem.article.halter}">
																<f:then>
																	<f:for each="{halter}" as="h">
																		<f:if condition="{0:h.uid} == {0:noticeItem.article.halter.uid}">
																			<f:for each="{h.fixingoption}" as="v">
																				<f:if condition="{0:v.uid} == {0:noticeItem.article.halter.vid}">
																					<img width="120" height="120" src="<glacryl:ProductImage url='<f:base />' mini='true' img='{v.pic}' />" />
																				</f:if>
																			</f:for>		
																		</f:if>
																	</f:for>
																</f:then>
																<f:else>
																	&nbsp;
																</f:else>
															</f:if>
														</f:else>
													</f:if>
													</p>
												</f:if>
											</div>
											<div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
												<f:if condition="{noticeItem.article.bearbeitungen}">
													<f:then>
														<dl>
															<dt class="cart-detail-header">Kantenbearbeitung</dt>
															<dd>
																<span>
																	<f:for each="{kanten}" as="k">
																		<f:if condition="{0:k.uid} == {0:noticeItem.article.bearbeitungen.kanten.uid}" >
																			<span><b>{k.name}</b></span>
																			<f:if condition="{0:noticeItem.article.bearbeitungen.kanten.angle} != {0:''}" >
																				<span> - <b>Facette:</b> {noticeItem.article.bearbeitungen.kanten.facette} mm, <b>Facettenwinkel:</b> {noticeItem.article.bearbeitungen.kanten.angle}&deg;</span>
																			</f:if>
																		</f:if>
																	</f:for>
																</span>
															</dd>
														</dl>

														<f:if condition="{noticeItem.article.bearbeitungen.tempern}" >
															<dl>
																<dt class="cart-detail-header">Tempern</dt>
																<dd>
																	<span>
																		<b>
																			<f:if condition="{0:noticeItem.article.bearbeitungen.tempern.tempern} == {0:'true'}" >
																				<f:then>
																					Ja
																				</f:then>
																				<f:else>
																					Nein
																				</f:else>
																			</f:if>
																		</b>
																	</span>
																</dd>
															</dl>
														</f:if>

														<f:if condition="{noticeItem.article.bearbeitungen.ecken}" >
															<dl>
																<dt class="cart-detail-header">Eckbearbeitungen</dt>
																<f:for each="{ecken}" as="e">
																	<f:for each="{noticeItem.article.bearbeitungen.ecken}" as="bE">
																		<f:if condition="{0:e.uid} == {0:bE.uid}" >
																			<dd>
																				<span><b>Ecke:</b> {bE.corner} - <b>{e.name}</b>,</span> 
																			<f:if condition="{0:bE.radius} != {0:''}" >
																				<f:then>
																					<span><b>Radius:</b> {bE.radius} mm</span>
																				</f:then>
																				<f:else>
																					<span><b>X:</b> {bE.x} mm <b>Y:</b> {bE.y} mm</span>
																				</f:else>
																			</f:if>
																			</dd>
																		</f:if>
																	</f:for>
																</f:for>
															</dl>
														</f:if>
														<f:if condition="{noticeItem.article.bearbeitungen.bohrungen}" >
															<dl>
																<dt class="cart-detail-header">Bohrungen</dt>
																<f:for each="{noticeItem.article.bearbeitungen.bohrungen}" as="bB">
																	<dd>
																		<span><b>Ecke:</b> {bB.corner}</span>
																		<span><b>X:</b> {bB.x} mm</span>
																		<span><b>Y:</b> {bB.y} mm</span>
																		<span><b>&Oslash;-Bohrung:</b> {bB.dB} mm</span>
																	</dd>
																</f:for>
															</dl>
														</f:if>
														<f:if condition="{noticeItem.article.bearbeitungen.senkungen}" >
															<dl>
																<dt class="cart-detail-header">Senkbohrungen</dt>
																<f:for each="{noticeItem.article.bearbeitungen.senkungen}" as="bS">
																	<dd>
																		<span><b>Ecke:</b> {bS.corner}</span>
																		<span><b>X:</b> {bS.x} mm</span>
																		<span><b>Y:</b> {bS.y} mm</span>
																		<span><b>&Oslash;-Bohrung:</b> {bS.dB} mm</span>
																		<span><b>&Oslash;-Senkung:</b> {bS.dS} mm</span>
																	</dd>
																</f:for>
															</dl>
														</f:if>
														<f:if condition="{noticeItem.article.halter}" >
															<glacryl:Cart halter="true" obj="{noticeItem.article.halter}" dbData="{halter}" />
														</f:if>
													</f:then>
													<f:else>
														<f:if condition="{noticeItem.article.halter}">
															<f:then>
																<dl>
																	<dt class="cart-detail-header">Befestigung</dt>
																	<dd>
																	<f:for each="{halter}" as="h">
																		<f:if condition="{0:h.uid} == {0:noticeItem.article.halter.uid}" >
																			<f:for each="{h.fixingoption}" as="v">
																				<f:if condition="{0:v.uid} == {0:noticeItem.article.halter.vid}" >
																					<span><b>Art.Nr.:</b> </span><span>{v.articleNr}</span><br />
																					<span><b>Material:</b> </span><span>{v.material}</span><br />
																					<span><b>Wandabst.:</b> </span><span>{v.projection}mm</span><br />
																					<f:if condition="{v.plattenbohrungUnterseite} != 0">
																						<span><b>Bohr-&Oslash;:</b> </span><span>{v.drillDownside}mm</span><br />
																					</f:if>
																					<span><b>Passend für Materialstärken:</b> </span><span>von {v.fromSize}mm bis {v.toSize}mm</span><br />
																					<span><b>Haltermaße:</b> </span><span>
																						<f:if condition="{v.borderLength} == 0">
																							<f:then>
																								&Oslash; {v.diameter}mm
																							</f:then>
																							<f:else>
																								{v.borderLength} x {v.borderLength}mm
																							</f:else>
																						</f:if>
																					</span><br />
																				</f:if>
																			</f:for>
																		</f:if>
																	</f:for>
																	</dd>
																</dl>
															</f:then>
															<f:else>
																&nbsp;
															</f:else>
														</f:if>
													</f:else>
												</f:if>
											</div>
										</div>
									</td>
								</tr></f:comment>
							</f:for>
							</tbody>
						</table>
					</div>
				</f:then>
				<f:else>
					<div class="row cart-empty">
						<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
							<div class="cart-panel">
								Es liegen zur Zeit keine Artikel in Ihrer Merkliste!
							</div>
						</div>
					</div>
				</f:else>
			</f:if>
		</div>
	</div>
</div>