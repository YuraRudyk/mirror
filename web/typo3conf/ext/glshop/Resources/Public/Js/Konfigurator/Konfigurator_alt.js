!function($){function Corner(){this.corner=["E1","E2","E3","E4"];var e=!1,t=!1,n=!1,i=!1;this.setCorner=function(r){switch(r){case"E1":e=!0;break;case"E2":t=!0;break;case"E3":n=!0;break;case"E4":i=!0}},this.isCornerSet=function(r){switch(r){case"E1":return e;case"E2":return t;case"E3":return n;case"E4":return i}},this.unSetCorner=function(r){switch(r){case"E1":e=!1;break;case"E2":t=!1;break;case"E3":n=!1;break;case"E4":i=!1}}}var InputFieldTest={start:function(){var e=$(document).find("input[type=text]"),t=API.isDesktopTest();$.each(e,function(e,n){t?"filter-halterMitBohrung-artikel"==$(n).attr("id")||"filter-halterOhneBohrung-artikel"==$(n).attr("id")?$(n).attr("type","text").attr("maxlength",8):"user"==$(n).attr("id")?$(n).attr("type","text").removeAttr("maxlength"):$(n).attr("type","text").attr("maxlength",4):"user"==$(n).attr("id")?$(n).attr("type","text").removeAttr("maxlength"):$(n).attr("type","number").removeAttr("maxlength")})}},Tooltips={tips:{".right.info-icon.hOb":"#halter-ohneBohrung-info-tooltip",".right.info-icon.hMb":"#halter-mitBohrung-info-tooltip",".right.info-icon.bE":"#ecken-info-tooltip",".right.info-icon.bB":"#bohrung-info-tooltip",".right.info-icon.bS":"#senkung-info-tooltip",".right.info-icon.bK":"#kanten-info-tooltip",".info-icon-halter.eHoB":"#einzel-Halter-info-oB-tooltip",".info-icon-halter.eHmB":"#einzel-Halter-info-mB-tooltip",".right.info-icon.mat":"#material-info-tooltip",".ui-icon.ui-icon-info.ecken-info-btn":"#eckBearbeitung-info-tooltip"},initialize:function(){$(".info-icon, .info-icon-halter, .ecken-info-btn").each(function(){$(this).qtip({overwrite:!1,position:{my:"top right",at:"center left",adjust:{method:"shift",resize:!0,scroll:!1},viewport:$(window)},style:{widget:!0,def:!1},content:{text:$(Tooltips.getTooltipId($(this))).html(),button:!0},hide:{event:function(){return Tooltips.clearInfo(),API.MobileCheck()?!1:"mouseleave"}()},events:{show:function(e,t){var n="."+$(e.originalEvent.target).attr("class").replace(" ",".").replace(" ",".");if(".right.info-icon.mat"==n){var i=$(e.originalEvent.target);Tooltips.insertInfo(n,i)}else Tooltips.insertInfo(n)}}})})},getTooltipId:function(e){var t="."+e.attr("class").replace(" ",".").replace(" ",".");return Tooltips.tips[t]},clearInfo:function(){$("span.tooltip-halter-name").html(""),$("span.tooltip-halter-variante").html(""),$("span.tooltip-halter-artNr").html(""),$("span.tooltip-halter-preis").html(""),$("span.tooltip-halter-wa").html(""),$("span.tooltip-halter-material").html(""),$("span.tooltip-halter-mas").html(""),$("span.tooltip-halter-bohrung").html(""),$("p.tooltip-material-info").html(""),$("span.tooltip-material-name").html("")},insertInfo:function(e,t){switch(e){case".right.info-icon.mat":var n=t.parent("div").next("div").find("div").find("input[name=materialUid]").val(),i=t.parent("div").next("div").find("div").find("input[name=variantenUid]").val();API.isset(i)||(i=t.parent("div").next("div").find("div").find("select").val());var r=Konfigurator.helper.getMaterial(n,i);$("span.tooltip-material-name").html(r.material.name),$("p.tooltip-material-info").html(r.material.desc);break;case".info-icon-halter.eHmB":var a=$("#view-halterMitBohrung-auswahl select").val(),i=$("#view-halterMitBohrung-variantenId").val(),o=Konfigurator.helper.getHalter(a,i),l="0.00"!=o.variante.durchmesser?"&Oslash; "+API.dotToComma(o.variante.durchmesser):API.dotToComma(o.variante.halterkantenlaenge)+" x "+API.dotToComma(o.variante.halterkantenlaenge),r="-1.00"!=o.variante.materialVon&&"-1.00"!=o.variante.materialBis?"von "+API.dotToComma(o.variante.materialVon)+" bis "+API.dotToComma(o.variante.materialBis)+" mm":"alle";$("span.tooltip-halter-name").html(o.halter.name),$("span.tooltip-halter-variante").html(o.variante.name),$("span.tooltip-halter-artNr").html(o.variante.artnr),$("span.tooltip-halter-preis").html(API.dotToComma(o.variante.preis)),$("span.tooltip-halter-wa").html(API.dotToComma(o.variante.wandabstand)),$("span.tooltip-halter-material").html(r),$("span.tooltip-halter-mas").html(l),$("span.tooltip-halter-bohrung").html(API.dotToComma(o.variante.plattenbohrungUnterseite));break;case".info-icon-halter.eHoB":var a=$("#view-halterOhneBohrung-auswahl select").val(),i=$("#view-halterOhneBohrung-variantenId").val(),o=Konfigurator.helper.getHalter(a,i),l="0.00"!=o.variante.durchmesser?"&Oslash; "+API.dotToComma(o.variante.durchmesser):API.dotToComma(o.variante.halterkantenlaenge)+" x "+API.dotToComma(o.variante.halterkantenlaenge),r="-1.00"!=o.variante.materialVon&&"-1.00"!=o.variante.materialBis?"von "+API.dotToComma(o.variante.materialVon)+" bis "+API.dotToComma(o.variante.materialBis)+" mm":"alle";$("span.tooltip-halter-name").html(o.halter.name),$("span.tooltip-halter-variante").html(o.variante.name),$("span.tooltip-halter-artNr").html(o.variante.artnr),$("span.tooltip-halter-preis").html(API.dotToComma(o.variante.preis)),$("span.tooltip-halter-wa").html(API.dotToComma(o.variante.wandabstand)),$("span.tooltip-halter-material").html(r),$("span.tooltip-halter-mas").html(l)}}},Dispatcher={Type:{Material:1,Halter:2,Bearbeitung:3},errorFields:{Material:new Array,Halter:new Array,Bearbeitung:new Array},addErrorField:function(e,t){switch(e){case 1:this.errorFields.Material.push(t);break;case 2:this.errorFields.Halter.push(t);break;case 3:this.errorFields.Bearbeitung.push(t)}return this},clearErrorFields:function(e){switch(e){case 1:$.each(this.errorFields.Material,function(e,t){$(t).html("")}),this.errorFields.Material=new Array;break;case 2:$.each(this.errorFields.Halter,function(e,t){$(t).html("")}),this.errorFields.Halter=new Array;break;case 3:$.each(this.errorFields.Bearbeitung,function(e,t){$(t).html("")}),this.errorFields.Bearbeitung=new Array}return this},transition:{ecken:[]},clearTransition:function(){this.transition.ecken=[]}},API={usedIds:new Array,isMobile:window.matchMedia("only screen and (max-width: 750px)").matches,isTablet:window.matchMedia("only screen and (max-width: 974px)").matches,isDesktop:window.matchMedia("only screen and (min-width: 975px)").matches,MobileCheck:function(){return this.isMobileNew.any()&&this.isMobileEvent()},isMobileEvent:function(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}},isMobileNew:{Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return API.isMobileNew.Android()||API.isMobileNew.BlackBerry()||API.isMobileNew.iOS()||API.isMobileNew.Opera()||API.isMobileNew.Windows()}},isMobileTest:function(){var e=parseInt($(window).width());return 750>=e?!0:!1},isTabletTest:function(){var e=parseInt($(window).width());return 974>=e?!0:!1},isDesktopTest:function(){var e=parseInt($(window).width());return e>=975?!0:!1},createRandomNumber:function(){var e=Math.floor(10002*Math.random()+1);return-1==$.inArray(e,this.usedIds)?(this.usedIds.push(e),e):this.createRandomNumber()},ajax:function(async,data,type,dataType,sMsg,eMsg){var res=$.ajax({url:"index.php",async:async,global:!1,data:data,type:type,dataType:dataType,success:function(){null!=sMsg&&alert(sMsg)},error:function(){null!=eMsg&&alert(eMsg)}}).responseText;return"json"==dataType&&""!=res&&null!=res&&res.length>0&&(res=eval("("+res+")")),res},dotToComma:function(e){return e+="",e=e.replace(".",",")},commaToDot:function(e){return e+="",e=e.replace(".","."),e=e.replace(",",".")},inList:function(e,t){for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1},markEckenOption:function(e,t){var n=e.find("option"),i=t.val();"ALLE"==i?$(t)[0].selected?$.each(n,function(t,n){var i=$(n).val();"ALLE"!=i&&($(n).removeAttr("selected"),e.selectmenu("refresh",!0))}):$.each(n,function(e,t){var n=$(t).val();"ALLE"!=n&&"FREI"!=n?API.isset($(t).attr("disabled"))||$(t).attr("selected","selected"):"FREI"==n&&$(t).removeAttr("selected")}):"FREI"==i?$.each(n,function(e,t){"FREI"!=$(t).val()&&$(t).removeAttr("selected")}):"ALLE"!=i&&"FREI"!=i&&$.each(n,function(e,t){("ALLE"==$(t).val()||"FREI"==$(t).val())&&$(t).removeAttr("selected")})},markEckenCheckboxElementByLabel:function(e,t){var n=e.find("label");$.each(n,function(e,n){var i=$(n).find("input").val();i==t&&$(n).addClass("active")})},markEckenCheckbox:function(e){var t=$(e.target.parentElement).find("label"),n=$(e.target),i=n.find("input").val();if("ALLE"==i){var r=!1;API.MobileCheck()?n.hasClass("active")&&(r=!0):n.hasClass("active")||(r=!0),r?$.each(t,function(e,t){var n=$(t).find("input").val();"ALLE"!=n&&$(t).removeClass("active")}):$.each(t,function(e,t){var n=$(t).find("input").val();"ALLE"!=n&&"FREI"!=n?API.isset($(t).attr("disabled"))||$(t).addClass("active"):"FREI"==n&&$(t).removeClass("active")})}else"FREI"==i?$.each(t,function(e,t){"FREI"!=$(t).find("input").val()&&$(t).removeClass("active")}):"ALLE"!=i&&"FREI"!=i&&$.each(t,function(e,t){("ALLE"==$(t).find("input").val()||"FREI"==$(t).find("input").val())&&$(t).removeClass("active")})},disableOption:function(e){$(e).attr("disabled","disabled")},disableCheckBox:function(e){$(e).attr("disabled","disabled")},disableButton:function(e){$(e).prop("disabled",!0)},enableButton:function(e){$(e).prop("disabled",!1)},round:function(e,t){if(1>t||t>14)return!1;var n=Math.pow(10,t),i=(Math.round(e*n)/n).toString();return-1==i.indexOf(".")&&(i+="."),i+=n.toString().substring(1),parseFloat(i.substring(0,i.indexOf(".")+t+1))},priceView:function(e){function t(e,t,r){t||(t=0);var a="",o=0>e?"-":"",l=Math.pow(10,t),u=Math.abs(e);u=""+parseInt(u*l+.5)/l;var h=u.indexOf(".");for(r&&t&&(u+=(-1==h?".":"")+l.toString().substring(1)),h=u.indexOf("."),-1==h?h=u.length:a=n+u.substr(h+1,t);h>0;)a=h-3>0?i+u.substring(h-3,h)+a:u.substring(0,h)+a,h-=3;return o+a}var n=",",i=".";return t(e,2,!0)},isset:function(e){return"undefined"!=typeof e&&null!=e?!0:!1}},Validate={config:{regexp:{ganzeZahl:{exp:/^([0-9_])+$/i,text:"Dieses Feld darf nur ganze Zahlen enthalten!"},"float":{exp:/^([,.0-9_])+$/i,text:"Dieses Feld darf nur Kommazahlen enthalten!"}},material:{laser:{max:2e3,min:1500},sonst:{max:3e3,min:2e3}},facette:{max:20,min:0},maxQty:100},updateText:function(e,t){t?$(e).show().html(t):$(e).hide().html("")},addErrorStyle:function(e){e.attr("style","border: 1px solid #A51107 !important; color: #A51107 !important; overflow:hidden; padding:0px !important;")},removeErrorStyle:function(e){e.removeAttr("style")},emptyField:function(e,t){var n=[];for(var i in e)""==e[i].val()&&n.push(i);if(n.length>1){for(var r="Die Felder ",a=0;a<n.length;a++)r+=0==a?'"'+n[a]+'"':', "'+n[a]+'"';return r+=" d&uuml;rfen nicht leer sein!",this.updateText(t,r),!1}return 1==n.length?(this.updateText(t,'Das Feld "'+n[0]+'" darf nicht leer sein!'),!1):(this.updateText(t,""),!0)},checkRegexp:function(e,t,n){var i=null,r=null;return"undefined"==typeof n?(i=this.config.regexp.ganzeZahl.exp,r=this.config.regexp.ganzeZahl.text):"float"==n&&(i=this.config.regexp["float"].exp,r=this.config.regexp["float"].text),e.is(":visible")?i.test(e.val())?(this.removeErrorStyle(e),this.updateText(t,""),!0):(this.addErrorStyle(e),this.updateText(t,r),!1):(this.removeErrorStyle(0),this.updateText(t,""),!0)},checkNumber:function(e,t,n){if(e.is(":visible")){var i=e.val();return isNaN(i)?(this.addErrorStyle(e),this.updateText(t,"Bitte geben Sie in das markierte Feld eine Zahl ein!"),!1):0!=i||n?(this.removeErrorStyle(e),this.updateText(t,""),!0):(this.addErrorStyle(e),this.updateText(t,'Das markierte Feld  darf nicht "0" sein!'),!1)}return this.removeErrorStyle(0),this.updateText(t,""),!0},isRadioSelected:function(e,t){return e.is(":visible")?""==e.find(":radio:checked").val()||"undefined"==typeof e.find(":radio:checked").val()?(this.addErrorStyle(e),this.updateText(t,"Bitte w&auml;hlen Sie einen Wert im markierten Bereich aus!"),!1):(this.removeErrorStyle(e),this.updateText(t),!0):!0},isButtonSelected:function(e,t){return e.is(":visible")?""==e.find("button.active").val()||"undefined"==typeof e.find("button.active").val()?(this.addErrorStyle(e),this.updateText(t,"Bitte w&auml;hlen Sie einen Wert im markierten Bereich aus!"),!1):(this.removeErrorStyle(e),this.updateText(t),!0):!0},isCheckboxSelected:function(e,t){return e.is(":visible")?0==e.find("label.active").length||"undefined"==typeof e.find("label.active")?(this.addErrorStyle(e),this.updateText(t,"Bitte w&auml;hlen Sie einen Wert im markierten Bereich aus!"),!1):(this.removeErrorStyle(e),this.updateText(t),!0):!0},checkFacettenEingabe:function(e,t,n,i){var r=null,a=!1,o=null,n=n||!1,l=Number(Material.getCurrentConfiguration().size),u=this.config.facette.max,h=this.config.facette.min;if("object"==typeof e&&(a=e.is(":visible"),o=e.val()),a||n){if("12"==t?r=n?l-.213*Number(e):l-.213*o:"45"==t&&(r=n?l-Number(e):l-o),Number(o)>u)return n||(this.addErrorStyle(e),this.updateText(i,"Die maximal m&ouml;gliche Facettenbreite von "+u+" mm darf nicht &uuml;berschritten werden!")),!1;if(Number(o)<h)return n||(this.addErrorStyle(e),this.updateText(i,"Die minimal m&ouml;gliche Facettenbreite von "+h+" mm darf nicht unterschritten werden!")),!1;if(null!=r&&Number(r)<1)return n||(this.addErrorStyle(e),this.updateText(i,"Die gew&uuml;nschte Facettenbreite ist bei gew&auml;hlter Materialst&auml;rke nicht m&ouml;glich. Bitte reduzieren Sie die Facettenbreite oder erh&ouml;hen Sie die Materialst&auml;rke.")),!1}return this.removeErrorStyle(e),this.updateText(i),!0},checkEckRadius:function(e,t,n){var i=Number(Grundeinstellung.getCurrentConfiguration().width),r=Number(Grundeinstellung.getCurrentConfiguration().height),a=Number(Math.min(i,r)),t=t||!1,o=!1,l=null;return"object"==typeof e?(o=e.is(":visible"),l=Number(e.val())):l=e,(o||t)&&l>a?(t||(this.addErrorStyle(e),this.updateText(n,"Die Gr&ouml;&szlig;e vom Eckradius darf die kleinste Kante nicht &uuml;berschreiten ("+a+" mm)!")),!1):(this.removeErrorStyle(e),this.updateText(n),!0)},materialSet:function(e){var t=Material.getCurrentConfiguration().size;if(API.isset(e)){if(!API.isset(t))return this.updateText(e,"Bitte w&auml;hlen Sie zuerst eine Materialvariante aus!"),!1;this.updateText(e)}else if(!API.isset(t))return!1;return!0},material:function(e,t,n,i){var r=Number(e.val()),a=Number(t.val()),o=0,l=0,u=null;if(u="undefined"==typeof i?Bearbeitungen.Kanten.getCurrentConfiguration():{uid:i},2==u.uid||4==u.uid?(o=this.config.material.laser.max,l=this.config.material.laser.min):(o=this.config.material.sonst.max,l=this.config.material.sonst.min),0!=r&&0!=a)if(r>a){if(r>o)return this.updateText(n,'Das Feld "Breite" darf den Maximalwert von '+o+" mm nicht &uuml;bersreiten!"),this.addErrorStyle(e),this.removeErrorStyle(t),!1;if(20>r)return this.updateText(n,'Das Feld "Breite" darf den Minimalwert von 20 mm nicht unterschreiten!'),this.addErrorStyle(e),this.removeErrorStyle(t),!1;if(a>l)return this.updateText(n,'Das Feld "H&ouml;he" darf den Maximalwert von '+l+" mm nicht &uuml;berschreiten!"),this.addErrorStyle(t),this.removeErrorStyle(e),!1;if(20>a)return this.updateText(n,'Das Feld "H&ouml;he" darf den Minimalwert von 20 mm nicht unterschreiten!'),this.addErrorStyle(t),this.removeErrorStyle(e),!1}else{if(a>o)return this.updateText(n,'Das Feld "H&ouml;he" darf den Maximalwert von '+o+" mm nicht &uuml;berschreiten!"),this.addErrorStyle(t),this.removeErrorStyle(e),!1;if(20>a)return this.updateText(n,'Das Feld "H&ouml;he" darf den Minimalwert von 20 mm nicht unterschreiten!'),this.addErrorStyle(t),this.removeErrorStyle(e),!1;if(r>l)return this.updateText(n,'Das Feld "Breite" darf den Maximalwert von '+l+" mm nicht &uuml;berschreiten!"),this.addErrorStyle(e),this.removeErrorStyle(t),!1;if(20>r)return this.updateText(n,'Das Feld "Breite" darf den Minimalwert von 20 mm nicht unterschreiten!'),this.addErrorStyle(e),this.removeErrorStyle(t),!1}else{if(0==r)return this.addErrorStyle(e),this.removeErrorStyle(t),this.updateText(n,"Bitte geben Sie eine Zahl ein!"),!1;if(0==a)return this.addErrorStyle(t),this.removeErrorStyle(e),this.updateText(n,"Bitte geben Sie eine Zahl ein!"),!1}return this.removeErrorStyle(t),this.removeErrorStyle(e),this.updateText(n,""),!0}},Price={rabatt:{product:{0:{preisVon:0,preisBis:100,rabatt:1},1:{preisVon:100,preisBis:250,rabatt:.89},2:{preisVon:250,preisBis:500,rabatt:.85},3:{preisVon:500,preisBis:1e3,rabatt:.81},4:{preisVon:1e3,preisBis:2500,rabatt:.79},5:{preisVon:2500,preisBis:-1,rabatt:.76}}},konstanten:{arbeitsfaktor:.8,kZuschnitt1:2.19748e-7,kZuschnitt2:495982e-9,kZuschnitt3:16.4172,kSchwabeln1:1.23527e-9,kSchwabeln2:.00479476,kSchwabeln3:2,kFassen1:.00099607182,kFassen2:.2,kFacette1:.003,kPacket1:.3934,kPacket2:4,kPallete1:.35,kPallete2:4,sZuschnitt:30,sMacryl:60,sSchwabeln:30,sLaser:100,sBohrungen:30,minZuschnitt:5,vZuschnitt1:2e3,vZuschnitt2:1500,segeBlattZuschnitt:3,plattenBreite:2030,vSchwabeln:1200,vMacryl:200,tMacryl:2,tFacette:20,rLaser:13,tLaser1:3,tLaser2:1,tLaser3:10,aLaser:3.35,tBSLaser:10,tBSEinstellen:180,tBohrungen:15,tSenkungen:10,tLREcken1:15,tLREcken2:2,tLSEcken1:15,tLSEcken2:2,tZSEcken1:60,tZSEcken2:1.5},laserzeit:[{dicke:1,v:3750},{dicke:2,v:3250},{dicke:2.5,v:2500},{dicke:3,v:2200},{dicke:4,v:1800},{dicke:5,v:1600},{dicke:6,v:1400},{dicke:8,v:600},{dicke:10,v:500},{dicke:12,v:400},{dicke:15,v:300},{dicke:20,v:230}],bearbeitungen:[{label:"ges&auml;gte Kante",functions:["berechneZuschnitt"]},{label:"ges&auml;gte Kante",functions:["berechneZuschnitt"]},{label:"Laserkante",functions:["berechneLaser"]},{label:"ges&auml;gt &amp; gefasst",functions:["berechneZuschnitt","berechneKantenFasen"]},{label:"Laserkante gefasst",functions:["berechneLaser","berechneKantenFasen"]},{label:"diamantpoliert &amp; gefasst",functions:["berechneZuschnitt","berechneMacryl","berechneSchwabeln","berechneKantenFasen"]},{label:"facettiert &amp; poliert",functions:["berechneZuschnitt","berechneMacryl","berechneSchwabeln","berechneKantenFasen","berechneFacette"]}],createPriceView:function(){var e=parseInt(Grundeinstellung.getCurrentConfiguration().qty),t=parseFloat(this.calculate()),n=API.round(t/e,2);$("#cart-configuration-qty").html(e+" Stk."),$("#cart-configuration-onePrice").html("&aacute;  "+API.priceView(n)+" &euro; netto"),$(".cart-configuration-sumPrice").html(API.priceView(n*e)+" &euro;")},calculate:function(){for(var mPreis=0,bPreis=0,hPreis=0,shop=Konfigurator.prepareDataForImg(),config=shop.configuration,material=shop.material,shildSize=shop.materialConfig,kanten=shop.bearbeitungen.kanten,ecken=shop.bearbeitungen.ecken,bohrungen=shop.bearbeitungen.bohrungen,senkungen=shop.bearbeitungen.senkungen,tempern=shop.bearbeitungen.tempern,halter=shop.halter,qty=Number(Grundeinstellung.getCurrentConfiguration().qty),mFactor=Konfigurator.data.mFactor,mFactorInflation=parseFloat(Konfigurator.data.mFactorInflation),pFactorInflation=parseFloat(Konfigurator.data.pFactorInflation),eFactorInflation=parseFloat(Konfigurator.data.eFactorInflation),cutoff=parseFloat(Konfigurator.data.cutoff)/100+1,gesamtKosten=0,materialGesPreis=0,temperKilo=0,i=0;i<config.material.length;i++)if(config.material[i].uid==material.uid)for(var j=0;j<config.material[i].varianten.length;j++)if(config.material[i].varianten[j].uid==material.vid)for(var k=0;k<config.material[i].varianten[j].formen.length;k++)parseFloat(config.material[i].varianten[j].formen[k].dicke)==parseFloat(material.size)&&(materialGesPreis+=cutoff*parseFloat(shildSize.height)*parseFloat(shildSize.width)*qty*parseFloat(config.material[i].varianten[j].formen[k].preis)/1e6*mFactorInflation);tempern.tempern&&(temperKilo+=parseFloat(shildSize.height)*parseFloat(shildSize.width)/1e6*1.2*parseFloat(material.size)*qty),materialGesPreis=API.round(materialGesPreis,2);for(var i=0;i<mFactor.length;i++)materialGesPreis>mFactor[i].from&&materialGesPreis<=mFactor[i].to&&(mPreis+=materialGesPreis*mFactor[i].factor);var defaultKantenConfig=4,editId=defaultKantenConfig,bZeit=0;if(API.isset(kanten))for(var j=0;j<config.kanten.length;j++)kanten.uid==parseInt(config.kanten[j].uid)&&(editId=kanten.uid);for(var eckenQty=this.getEckenQty(ecken),daten={l:parseFloat(shildSize.height),b:parseFloat(shildSize.width),t:parseFloat(material.size),qty:parseInt(qty),bearbeitung:parseInt(editId),drill:this.getBohrQty(bohrungen),senk:this.getSenkQty(senkungen),rundecken:eckenQty.rund,schraegeecken:eckenQty.schraeg,halter:halter},j=0;j<Price.bearbeitungen.length;j++)if(j==editId){for(var k=0;k<Price.bearbeitungen[j].functions.length;k++){var execFunction=eval("this."+Price.bearbeitungen[j].functions[k]);bZeit+=execFunction(daten)}break}if(bZeit+=Price.berechneBohrungen(daten),bZeit+=Price.berechneRundEcken(daten),bZeit+=Price.berechneSchraegEcken(daten),bZeit+=Price.berechnePacken(daten),bPreis=Price.konstanten.arbeitsfaktor*bZeit*eFactorInflation,bPreis=API.round(bPreis,2),API.isset(halter)&&halter.length>0){for(var halterGesamtPreis=0,i=0;i<halter.length;i++){var realQty=halter[i].qty*qty,halterEinzelPreis=this.getProductPrice(halter[i].hid,halter[i].vid,"halter")*pFactorInflation;halterGesamtPreis+=halterEinzelPreis*realQty}hPreis+=API.round(halterGesamtPreis,2)}gesamtKosten=API.round(bPreis+hPreis+mPreis,2);var temperPreis=tempern.tempern?this.getTemperPrice(parseInt(qty),temperKilo):0;return gesamtKosten+temperPreis},getTemperPrice:function(e,t){var n=0,i=1,r=5,a=parseFloat(Konfigurator.data.tempern),o=e>r?t/e*(e-r)*i:0;return n=a+o,API.round(n/e,2)*e},getEckenQty:function(e){var t={rund:0,schraeg:0};if(API.isset(e)&&e.length>0)for(var n=0;n<e.length;n++)API.isset(e[n].radius)&&""!=e[n].radius?t.rund+="ALLE"==e[n].corner?4:1:t.schraeg+="ALLE"==e[n].corner?4:1;return t},getBohrQty:function(e){var t=0;if(API.isset(e)&&e.length>0)for(var n=0;n<e.length;n++)t+="ALLE"==e[n].corner?4:1;return t},getSenkQty:function(e){var t=0;if(API.isset(e)&&e.length>0)for(var n=0;n<e.length;n++)t+="ALLE"==e[n].corner?4:1;return t},getProductPrice:function(e,t,n){var i=Konfigurator.data.halter,r=0;if("halter"==n)for(var a=0;a<i.length;a++)if(i[a].uid==e)for(var o=0;o<i[a].varianten.length;o++)i[a].varianten[o].uid==t&&(r=i[a].varianten[o].preis);return API.round(r,2)},getRabattForProduct:function(e){var t=this.rabatt.product,n=1;for(var i in t)parseFloat(e)>=parseFloat(t[i].preisVon)&&parseFloat(e)<parseFloat(t[i].preisBis)?n=t[i].rabatt:parseFloat(e)>=parseFloat(t[i].preisVon)&&-1==parseInt(t[i].preisBis)&&(n=t[i].rabatt);return n},getSchwabelStapel:function(e){var t=0,n=e.b*e.l/1e6;return e.t>10?t=e.t:e.t>5&&e.t<=10?t=.3>=n?2*e.t:e.t:e.t>0&&e.t<=5&&(t=.3>=n?4*e.t:e.t),t},getZuschnittStapel:function(e){var t=0,n=e.b*e.l/1e6;return e.t>10?t=e.t:e.t>=6&&e.t<=10?t=.3>=n?30:e.t:e.t>0&&e.t<5?t=.06>=n?25:e.t:5==e.t&&(t=.06>=n?60:.08>=n?30:e.t),t},berechneZuschnitt:function(e){var t=0,n=e.l,i=e.b;return i>Price.konstanten.plattenBreite&&(i=e.l,n=e.b),t+=Price.konstanten.minZuschnitt+Price.konstanten.plattenBreite/Price.konstanten.vZuschnitt1*Math.ceil(e.qty/Math.floor(Price.konstanten.plattenBreite/(i+Price.konstanten.segeBlattZuschnitt)))+(n+Price.konstanten.segeBlattZuschnitt)/Price.konstanten.vZuschnitt2*Math.min(e.qty+1,Math.floor(Price.konstanten.plattenBreite/(i+Price.konstanten.segeBlattZuschnitt))+1)*Math.ceil(Math.ceil(e.qty/Math.floor(Price.konstanten.plattenBreite/(i+Price.konstanten.segeBlattZuschnitt)))*e.t/Price.getZuschnittStapel(e)),API.round(t,2)},berechneMacryl:function(e){var t=2*(e.l+e.b),n=0;return n=(t/Price.konstanten.vMacryl+Price.konstanten.tMacryl)*Math.ceil(e.t*e.qty/Price.konstanten.sMacryl),API.isset(e.schraegeecken)&&e.schraegeecken>0&&(n+=(40*e.schraegeecken/Price.konstanten.vMacryl+Price.konstanten.tMacryl)*Math.ceil(e.t*e.qty/Price.konstanten.sMacryl)),API.round(n,2)},berechneSchwabeln:function(e){var t=2*(e.l+e.b),n=0;return n+=t/Price.konstanten.vSchwabeln*Math.ceil(e.t*e.qty/Price.getSchwabelStapel(e)),API.round(n,2)},berechneKantenFasen:function(e){var t=2*(e.l+e.b),n=0;return n+=Price.konstanten.kFassen1*t*e.qty+Price.konstanten.kFassen2,API.round(n,2)},berechneFacette:function(e){var t=0,n=2*(e.l+e.b);return t+=Price.konstanten.tFacette+Price.konstanten.kFacette1*n*e.qty,API.round(t,2)},berechneLaser:function(e){var t=0,n=2*(e.l+e.b),i=e.l*e.b/1e6,r=Math.floor(Price.konstanten.aLaser/i),a=API.round(e.qty/r,4),o=r*e.t/Price.konstanten.sLaser;t+=Price.konstanten.rLaser,t+=3+Price.konstanten.tLaser1*a;for(var l=0;l<Price.laserzeit.length;l++)if(e.t<=parseFloat(Price.laserzeit[l].dicke)){t+=n*e.qty/Price.laserzeit[l].v;break}return t+=(e.qty*Price.konstanten.tLaser2+(o*(a-1)+Math.ceil((e.qty-r*(a-1))*e.t/Price.konstanten.sLaser))*Price.konstanten.tLaser3)/60,API.round(t,2)},berechneBohrungen:function(e){var t=0,n=0;return 2==e.bearbeitung||4==e.bearbeitung?(0!=e.drill&&(t=Price.konstanten.tBSLaser+e.drill*Price.konstanten.tBohrungen*e.qty),0!=e.senk&&(n=Price.konstanten.tBSLaser+e.senk*(Price.konstanten.tBohrungen+Price.konstanten.tSenkungen)*e.qty)):(0!=e.drill&&(t=Price.konstanten.tBSEinstellen+e.drill*Math.ceil(e.t*e.qty/Price.konstanten.sBohrungen)*Price.konstanten.tBohrungen),0!=e.senk&&(n=Price.konstanten.tBSEinstellen+e.senk*Math.ceil(e.t*e.qty/Price.konstanten.sBohrungen)*Price.konstanten.tBohrungen+e.senk*Price.konstanten.tSenkungen*e.qty)),API.round((t+n)/60,2)},berechneRundEcken:function(e){var t=0;return(2==e.bearbeitung||4==e.bearbeitung)&&(t=Price.konstanten.tLREcken1*e.rundecken*(1+(e.qty+1)*Price.konstanten.tLREcken2)),API.round(t/60,2)},berechneSchraegEcken:function(e){var t=0;if(2==e.bearbeitung||4==e.bearbeitung)t=Price.konstanten.tLSEcken1*e.schraegeecken*(1+(e.qty+1)*Price.konstanten.tLSEcken2);else{if(5==e.bearbeitung||6==e.bearbeitung)return t=Price.konstanten.tZSEcken1*e.schraegeecken*(.5+(e.qty+1)*Price.konstanten.tZSEcken2)/60,t+=(40*e.schraegeecken/Price.konstanten.vMacryl+Price.konstanten.tMacryl)*Math.ceil(e.t*e.qty/Price.konstanten.sMacryl);t=Price.konstanten.tZSEcken1*e.schraegeecken*(.5+(e.qty+1)*Price.konstanten.tZSEcken2)}return API.round(t/60,2)},berechnePacken:function(e){var t=0,n=0,i=0,r=0,a=0,o=0,l=.05;if(n+=1.2*e.l*e.b*e.t*e.qty/1e6,API.isset(e.halter)){var u=e.qty*e.halter.length;n+=l*u}e.l>e.b?(e.l>i&&(i=e.l),e.b>r&&(r=e.b)):(e.b>i&&(i=e.b),e.l>r&&(r=e.l)),a+=e.t*e.qty,o+=e.qty;var h=!1,c=0;return n>40?((i>1200||r>800)&&(h=!0,c=40*Price.konstanten.arbeitsfaktor),t+=Price.konstanten.kPallete1*n):600>i&&600>r?t=Price.konstanten.kPacket1*o*(i*r/1e6):i+2*r+2*a>3e3?t+=Price.konstanten.kPallete1*n:t=Price.konstanten.kPacket1*o*(i*r/1e6),API.round(t,2)}},Material={current:{uid:null,vid:null,size:null},checkedVariante:null,getCurrentConfiguration:function(){return this.current},setMaterial:function(e){return this.current.uid=e,this},setVariante:function(e){return this.current.vid=e,this},setSize:function(e){return this.current.size=e,this},clearCurrentConfiguration:function(){return this.setMaterial(null).setVariante(null).setSize(null),null!=this.checkedVariante&&($(this.checkedVariante).prop("checked",!1),this.checkedVariante=null),this}},Bearbeitungen={Tempern:{current:{tempern:!1},getCurrentConfiguration:function(){return this.current},setTempern:function(e){return this.current.tempern=e,this},clearCurrentConfiguration:function(){return this.setTempern(!1),this}},Kanten:{current:{uid:1,facette:null,angle:null},getCurrentConfiguration:function(){return this.current},setBearbeitung:function(e){return this.current.uid=e,this},setFacette:function(e){return this.current.facette=e,this},setAngle:function(e){return this.current.angle=e,this},clearCurrentConfiguration:function(){var e=4;return this.setBearbeitung(e).setFacette(null).setAngle(null),this}},Ecken:{current:[],corner:new Corner,getCurrentConfiguration:function(){return this.current},addConfiguration:function(e,t,n,i,r){var a={uid:e,corner:t,radius:n,x:i,y:r};return this.current.push(a),this.corner.setCorner(t),this},editConfiguration:function(e,t,n,i,r,a){this.removeConfiguration(a),this.addConfiguration(e,t,n,i,r)},removeConfiguration:function(e){for(var t=[],n=0;n<this.current.length;n++)this.current[n].corner!=e?t.push(this.current[n]):this.corner.unSetCorner(e);return this.clearCurrentConfiguration(!1).setCurrentConfiguration(t),this},setCurrentConfiguration:function(e){this.current=e},clearCurrentConfiguration:function(e){return this.current=[],e&&(this.corner=new Corner),this}},Bohrungen:{current:[],corner:new Corner,getCurrentConfiguration:function(){return this.current},getConfiguration:function(e){for(var t=null,n=0;n<this.current.length;n++)this.current[n].index==e&&(t=this.current[n]);return t},addConfiguration:function(e,t,n,i,r,a,o){API.isset(a)||(a=API.createRandomNumber());var l={index:a,uid:e,corner:t,dB:n,x:i,y:r};return this.current.push(l),this.corner.setCorner(t),o?a:this},editConfiguration:function(e,t,n,i,r,a,o){return this.removeConfiguration(e),o?this.addConfiguration(t,n,i,r,a,e,o):void this.addConfiguration(t,n,i,r,a,e)},removeConfiguration:function(e){for(var t=[],n=0;n<this.current.length;n++)this.current[n].index!=e?t.push(this.current[n]):this.corner.unSetCorner(this.current[n].corner);return this.clearCurrentConfiguration(!1).setCurrentConfiguration(t),this},setCurrentConfiguration:function(e){this.current=e},clearCurrentConfiguration:function(e){return this.current=[],e&&(this.corner=new Corner),this}},Senkungen:{current:[],corner:new Corner,getCurrentConfiguration:function(){return this.current},getConfiguration:function(e){for(var t=null,n=0;n<this.current.length;n++)this.current[n].index==e&&(t=this.current[n]);return t},addConfiguration:function(e,t,n,i,r,a,o,l,u){API.isset(l)||(l=API.createRandomNumber());var h={index:l,uid:e,corner:t,m:n,dB:i,dS:r,x:a,y:o};return this.current.push(h),this.corner.setCorner(t),u?l:this},editConfiguration:function(e,t,n,i,r,a,o){this.removeConfiguration(e);for(var l=0,u=0,h=Konfigurator.data.senkungen,c=0;c<h.length;c++)parseFloat(h[c].gewinde)==parseFloat(i)&&(l=parseFloat(h[c].bohrung),u=parseFloat(h[c].senkung));return o?this.addConfiguration(t,n,i,l,u,r,a,e,o):void this.addConfiguration(t,n,i,l,u,r,a,e)},removeConfiguration:function(e){for(var t=[],n=0;n<this.current.length;n++)this.current[n].index!=e?t.push(this.current[n]):this.corner.unSetCorner(this.current[n].corner);return this.clearCurrentConfiguration(!1).setCurrentConfiguration(t),this},setCurrentConfiguration:function(e){this.current=e},clearCurrentConfiguration:function(e){return this.current=[],e&&(this.corner=new Corner),this}}},Halter={current:[],currentEditing:null,corner:new Corner,getCurrentConfiguration:function(){return this.current},addConfiguration:function(e,t,n,i,r,a,o,l){API.isset(a)||(a=API.createRandomNumber()),"ALLE"==n?o=4:null!=n&&(o=1);var u={index:a,hid:e,vid:t,corner:n,x:i,y:r,qty:o,bohrIndex:l};return this.current.push(u),this.corner.setCorner(n),this},getConfiguration:function(e){for(var t=0;t<this.current.length;t++)if(this.current[t].index==e)return this.current[t]},getHalterByBohrIndex:function(e){for(var t=0;t<this.current.length;t++)if(this.current[t].bohrIndex==e)return this.current[t]},editConfiguration:function(e,t,n,i,r,a,o,l){for(var u=Halter.getConfiguration(e),h=Konfigurator.helper.getHalter(t,n),c=h.variante.plattenbohrungUnterseite,s=0,g=0,d=Konfigurator.data.senkungen,f=0;f<d.length;f++)parseFloat(d[f].bohrung)==parseFloat(c)&&(s=parseFloat(d[f].gewinde),g=parseFloat(d[f].senkung));API.isset(l)||API.isset(o)||("7"==u.hid?"7"!=h.halter.uid?(Bearbeitungen.Senkungen.removeConfiguration(u.bohrIndex),l=Bearbeitungen.Bohrungen.addConfiguration(1,i,c,r,a,null,!0)):l=Bearbeitungen.Senkungen.editConfiguration(u.bohrIndex,2,i,s,r,a,!0):"7"==h.halter.uid?(Bearbeitungen.Bohrungen.removeConfiguration(u.bohrIndex),l=Bearbeitungen.Senkungen.addConfiguration(2,i,s,c,g,r,a,null,!0)):l=Bearbeitungen.Bohrungen.editConfiguration(u.bohrIndex,1,i,c,r,a,!0)),this.removeConfiguration(e),API.isset(o)?this.addConfiguration(t,n,i,r,a,e,o,l):this.addConfiguration(t,n,i,r,a,e,null,l)},removeConfiguration:function(e){for(var t=[],n=0;n<this.current.length;n++)this.current[n].index!=e?t.push(this.current[n]):this.corner.unSetCorner(this.current[n].corner);
return this.clearCurrentConfiguration(!1).setCurrentConfiguration(t),this},setCurrentConfiguration:function(e){this.current=e},clearCurrentConfiguration:function(e){return this.current=[],e&&(this.corner=new Corner),this},checkConfiguration:function(){for(var e=this.current,t=this.current.length,n=0;t>n;n++){var i=Konfigurator.helper.getHalter(e[n].hid,e[n].vid);"kante"==i.variante.position?View.Halter.ohneBohrung.istHalterErlaubt(e[n].hid)||(this.removeConfiguration(e[n].index),View.Halter.ohneBohrung.createSelectionView(),View.Configuration.createView.initialize()):View.Halter.mitBohrung.istHalterErlaubt(e[n].hid)||(Bearbeitungen.Bohrungen.removeConfiguration(e[n].bohrIndex),this.removeConfiguration(e[n].index),View.Halter.mitBohrung.createSelectionView(),View.Halter.mitBohrung.createEckSelectionView(),View.Bearbeitungen.Bohrungen.createEckSelectionView(),View.Bearbeitungen.Bohrungen.createSelectionView(),View.Configuration.createView.initialize(),Konfigurator.helper.drawCADImg())}}},Grundeinstellung={current:{qty:0,width:0,height:0},setQty:function(e){return this.current.qty=e,this},setWidth:function(e){return this.current.width=e,this},setHeight:function(e){return this.current.height=e,this},clearCurrentConfiguration:function(){return this.setQty(0).setWidth(0).setHeight(0),this},getCurrentConfiguration:function(){return this.current}},Konfigurator={data:null,schild:null,mobileSchild:null,dependencies:{kanten:[{uid:1,material:[1,2,3]},{uid:2,material:[1,2]},{uid:3,material:[1,2,3]},{uid:4,material:[1,2]},{uid:5,material:[1,2,3]},{uid:6,material:[1,2,3]}],ecken:[{uid:1,kanten:[1,2,3,4,5,6]},{uid:2,kanten:[2,4]}]},config:{materialImgPfad:"typo3conf/ext/glshop/Resources/Public/Img/Material/",halterImgPfad:"typo3conf/ext/glshop/Resources/Public/Img/Products/",bearbeitungImgPfad:"typo3conf/ext/glshop/Resources/Public/Img/Editing/",imgsUrl:"typo3conf/ext/glshop/Resources/Public/Img/"},initialize:function(){$(window).resize(function(){InputFieldTest.start()});var e=new Object;return e.eID="ajaxDispatcher",e.request={pluginName:"Glacrylshop",controller:"Aj",action:"ajax",arguments:{uid:"",positionNr:$("#edit-position-nr").val()}},this.data=API.ajax(!1,e,"GET","json"),this.schild=new Schild,this},createView:function(){return API.isset(this.data.edit)&&0!=this.data.edit.length&&(this.fillEditData(),$("#editCartBtn").show(),$("#editCartMobileBtn").show(),$("#addToCartBtn").hide(),$("#addToCartMobileBtn").hide(),API.MobileCheck()?$("#mobile-footer-data").show():$("#mobile-footer-data").hide()),View.initializeFrontEnd(),this},fillEditData:function(){if(API.isset(this.data.edit.article)){var e=this.data.edit.article.material;Material.setMaterial(e.uid),Material.setVariante(e.vid),Material.setSize(e.size);var t=this.data.edit.article.materialConfig;Grundeinstellung.setQty(this.data.edit.qty),Grundeinstellung.setWidth(t.width),Grundeinstellung.setHeight(t.height);var n=this.data.edit.article.bearbeitungen.kanten;Bearbeitungen.Kanten.setBearbeitung(n.uid),Bearbeitungen.Kanten.setFacette(n.facette),Bearbeitungen.Kanten.setAngle(n.angle);var i=this.data.edit.article.bearbeitungen.ecken;if(API.isset(i))for(var r=0;r<i.length;r++)Bearbeitungen.Ecken.addConfiguration(i[r].uid,i[r].corner,i[r].radius,i[r].x,i[r].y);var a=this.data.edit.article.bearbeitungen.bohrungen;if(API.isset(a)){for(var r=0;r<a.length;r++)Bearbeitungen.Bohrungen.addConfiguration(a[r].uid,a[r].corner,a[r].dB,a[r].x,a[r].y,a[r].index);View.Bearbeitungen.Bohrungen.createSelectionView()}var o=this.data.edit.article.bearbeitungen.senkungen;if(API.isset(o)){for(var r=0;r<o.length;r++)Bearbeitungen.Senkungen.addConfiguration(o[r].bearbeitung,o[r].corner,o[r].m,o[r].dB,o[r].dS,o[r].x,o[r].y,o[r].index);View.Bearbeitungen.Senkungen.createSelectionView()}var l=this.data.edit.article.halter;if(API.isset(l)){for(var r=0;r<l.length;r++)API.isset(l[r].corner)&&""!=l[r].corner?Halter.addConfiguration(l[r].hid,l[r].vid,l[r].corner,l[r].x,l[r].y,l[r].index,l[r].qty,l[r].bohrIndex):Halter.addConfiguration(l[r].hid,l[r].vid,null,null,null,l[r].index,l[r].qty);View.Halter.ohneBohrung.createSelectionView(),View.Halter.mitBohrung.createSelectionView()}var u=this.data.edit.article.bearbeitungen.tempern;API.isset(u)&&"true"==u.tempern&&(Bearbeitungen.Tempern.setTempern(!0),setTimeout(function(){$("#configuration-tempern").prop("checked",!0)},150)),$("#view-konfigurator-img").show(),Konfigurator.helper.drawCADImg(),this.iniEditFields(),Price.createPriceView(),$("#view-configuration-priceview").show()}},iniEditFields:function(){if($("#view-configuration-qty").val(Grundeinstellung.getCurrentConfiguration().qty),parseInt(Grundeinstellung.getCurrentConfiguration().qty)>5){var e=Konfigurator.prepareDataForImg(),t=e.material,n=e.materialConfig,i=parseFloat(n.height)*parseFloat(n.width)/1e6*1.2*parseFloat(t.size)*Grundeinstellung.getCurrentConfiguration().qty,r='<input type="checkbox" id="configuration-tempern">+'+API.priceView(Price.getTemperPrice(parseInt(Grundeinstellung.getCurrentConfiguration().qty),i))+"€";$("#view-configuration-tempern span label").html(r)}$("#view-configuration-width").val(Grundeinstellung.getCurrentConfiguration().width),$("#view-configuration-height").val(Grundeinstellung.getCurrentConfiguration().height)},resetKonfiguratorView:function(){return Material.clearCurrentConfiguration(),Bearbeitungen.Kanten.clearCurrentConfiguration(),Bearbeitungen.Ecken.clearCurrentConfiguration(!0),Bearbeitungen.Bohrungen.clearCurrentConfiguration(!0),Bearbeitungen.Senkungen.clearCurrentConfiguration(!0),Bearbeitungen.Tempern.clearCurrentConfiguration(),Halter.clearCurrentConfiguration(!0),this.resetKonfiguratorInputs(),$("#view-konfigurator-img").hide(),$("#view-configuration-priceview").hide(),this.createView(),this},resetKonfiguratorInputs:function(){$("#view-configuration-qty").val("1");var e='<input type="checkbox" id="configuration-tempern">+'+API.priceView(Price.getTemperPrice(parseInt(1),0))+"€";$("#view-configuration-tempern span label").html(e),$("#view-configuration-width").val(""),$("#view-configuration-height").val(""),$("#configuration-tempern").prop("checked",!1),$("#view-halterMitBohrung-x").val(""),$("#view-halterMitBohrung-y").val(""),$("#view-halterOhneBohrung-qty").val(""),$("#view-kanten-facette").val(""),$("#view-kanten-angle").val("45"),$("#view-eckbearbeitung-x").val(""),$("#view-eckbearbeitung-y").val(""),$("#view-eckbearbeitung-radius").val(""),$("#view-bohrungen-d").val(""),$("#view-bohrungen-x").val(""),$("#view-bohrungen-y").val(""),$("#view-senkungen-x").val(""),$("#view-senkungen-y").val("")},clearEditState:function(){Konfigurator.data.edit=null,$("#edit-position-nr").val("")},prepareDataForImg:function(){var e={configuration:Konfigurator.data,material:Material.getCurrentConfiguration(),materialConfig:Grundeinstellung.getCurrentConfiguration(),bearbeitungen:{kanten:Bearbeitungen.Kanten.getCurrentConfiguration(),ecken:Bearbeitungen.Ecken.getCurrentConfiguration(),bohrungen:Bearbeitungen.Bohrungen.getCurrentConfiguration(),senkungen:Bearbeitungen.Senkungen.getCurrentConfiguration(),tempern:Bearbeitungen.Tempern.getCurrentConfiguration()},halter:Halter.getCurrentConfiguration()};return e},getDataForCart:function(){var e={material:Material.getCurrentConfiguration(),materialConfig:Grundeinstellung.getCurrentConfiguration(),bearbeitungen:{kanten:Bearbeitungen.Kanten.getCurrentConfiguration(),ecken:Bearbeitungen.Ecken.getCurrentConfiguration(),bohrungen:Bearbeitungen.Bohrungen.getCurrentConfiguration(),senkungen:Bearbeitungen.Senkungen.getCurrentConfiguration(),tempern:Bearbeitungen.Tempern.getCurrentConfiguration()},halter:Halter.getCurrentConfiguration()};return e},helper:{drawCADImg:function(){var e=Konfigurator.prepareDataForImg();Konfigurator.schild.initialize("view-konfigurator-img",e).draw();var t=$("#view-konfigurator-img").getCanvasImage("png");$("#konfigurator-img-mobile").attr("src",t),t=null},getMiniImgData:function(e,t){switch(e){case"path":return"mini/";case"name":var n=t.split(".");return n[0]+"Mini.jpg"}},isEckeForKanteEnabled:function(e,t){var n=Konfigurator.dependencies.ecken;if(null!=t)for(var i=0;i<n.length;i++)if(n[i].uid==e)return $.inArray(parseInt(t),n[i].kanten)>-1?!0:!1},getMaterial:function(e,t){for(var n=Konfigurator.data.material,i={material:null,variante:null},r=0;r<n.length;r++)if(n[r].uid==e&&(i.material=n[r],API.isset(t)))for(var a=0;a<n[r].varianten.length;a++)n[r].varianten[a].uid==t&&(i.variante=n[r].varianten[a]);return i},getKanten:function(e){for(var t=Konfigurator.data.kanten,n=null,i=0;i<t.length;i++)t[i].uid==e&&(n=t[i]);return n},getEcken:function(e){for(var t=Konfigurator.data.ecken,n=null,i=0;i<t.length;i++)t[i].uid==e&&(n=t[i]);return n},getBohrungen:function(e){for(var t=Konfigurator.data.bohrungen,n=null,i=0;i<t.length;i++)t[i].uid==e&&(n=t[i]);return n},getSenkungen:function(e){for(var t=Konfigurator.data.senkungen,n=null,i=0;i<t.length;i++)parseFloat(t[i].gewinde)==parseFloat(e)&&(n=t[i]);return n},getHalter:function(e,t){for(var n=Konfigurator.data.halter,i={halter:null,variante:null},r=0;r<n.length;r++)if(n[r].uid==e&&(i.halter={uid:n[r].uid,pid:n[r].pid,name:n[r].name,bild:n[r].bild},API.isset(t)))for(var a=0;a<n[r].varianten.length;a++)n[r].varianten[a].uid==t&&(i.variante=n[r].varianten[a]);return i}}},HalterFilter={on:!1,onMit:!1,onOhne:!1,config:{mit:{normalerBereich:".view-vorschau-mBohrung",filterBereich:".view-halterAuswahl-mBohrung",container:"#filter-halterMitBohrung-Container",filter:{verwendung:{type:"select",id:"#filter-halterMitBohrung-verwendung"},material:{type:"select",id:"#filter-halterMitBohrung-material"},artNr:{type:"input",id:"#filter-halterMitBohrung-artikel"}}},ohne:{normalerBereich:".view-vorschau-oBohrung",filterBereich:".view-halterAuswahl-oBohrung",container:"#filter-halterOhneBohrung-Container",filter:{verwendung:{type:"select",id:"#filter-halterOhneBohrung-verwendung"},material:{type:"select",id:"#filter-halterOhneBohrung-material"},artNr:{type:"input",id:"#filter-halterOhneBohrung-artikel"}}}},data:null,mSize:null,halter:null,iniFirst:function(){this.iniActions()},initialize:function(e,t){this.data=e,this.mSize=t,this.halter=[],this.iniHalterObjects(),this.iniFilter(),this.createMitView(),this.createOhneView()},iniFilter:function(){$(this.config.mit.filter.material.id).html(this.getMaterialFilterContent(!1)),$(this.config.mit.filter.verwendung.id).html(this.getVerwendungFilterContent(!1)),$(this.config.ohne.filter.material.id).html(this.getMaterialFilterContent(!0)),$(this.config.ohne.filter.verwendung.id).html(this.getVerwendungFilterContent(!0))},getMaterialFilterContent:function(e){for(var t=[],n=[],i=0;i<this.halter.length;i++)this.halter[i].kante?-1==$.inArray(this.halter[i].material,n)&&n.push(this.halter[i].material):-1==$.inArray(this.halter[i].material.trim(),t)&&t.push(this.halter[i].material.trim());var r="",a=e?n:t;r+='<option value="choose">Bitte w&auml;hlen</option>';for(var i=0;i<a.length;i++)r+='<option value="'+a[i]+'">'+a[i]+"</option>";return r},getVerwendungFilterContent:function(e){for(var t=[],n=[],i=0;i<this.halter.length;i++)this.halter[i].kante?-1==$.inArray(this.halter[i].verwendung,n)&&n.push(this.halter[i].verwendung):-1==$.inArray(this.halter[i].verwendung,t)&&t.push(this.halter[i].verwendung);var r="",a=e?n:t;r+='<option value="choose">Bitte w&auml;hlen</option>';for(var i=0;i<a.length;i++)r+='<option value="'+a[i]+'">'+a[i]+"</option>";return r},iniHalterObjects:function(){for(var e=0;e<this.data.length;e++)for(var t=0;t<this.data[e].varianten.length;t++)(parseFloat(this.mSize)>=parseFloat(this.data[e].varianten[t].materialVon)||-1==parseFloat(this.data[e].varianten[t].materialVon))&&(parseFloat(this.mSize)<=parseFloat(this.data[e].varianten[t].materialBis)||-1==parseFloat(this.data[e].varianten[t].materialBis))&&this.objToHtml(this.data[e].varianten[t],this.data[e].uid)},filterVerwendungMitHalter:function(){for(var e=$(this).val(),t=0;t<HalterFilter.halter.length;t++)"choose"!=e&&-1==HalterFilter.halter[t].verwendung.indexOf(e)?HalterFilter.halter[t].show=!1:HalterFilter.halter[t].show=!0;HalterFilter.createMitView()},filterArtNrMitHalter:function(){for(var e=$(this).val(),t=0;t<HalterFilter.halter.length;t++)""!=e&&-1==HalterFilter.halter[t].artnr.indexOf(e)?HalterFilter.halter[t].show=!1:HalterFilter.halter[t].show=!0;HalterFilter.createMitView()},filterMaterialMitHalter:function(){for(var e=$(this).val(),t=0;t<HalterFilter.halter.length;t++)"choose"!=e&&HalterFilter.halter[t].material!=e?HalterFilter.halter[t].show=!1:HalterFilter.halter[t].show=!0;HalterFilter.createMitView()},filterVerwendungOhneHalter:function(){for(var e=$(this).val(),t=0;t<HalterFilter.halter.length;t++)"choose"!=e&&-1==HalterFilter.halter[t].verwendung.indexOf(e)?HalterFilter.halter[t].show=!1:HalterFilter.halter[t].show=!0;HalterFilter.createOhneView()},filterArtNrOhneHalter:function(){for(var e=$(this).val(),t=0;t<HalterFilter.halter.length;t++)""!=e&&-1==HalterFilter.halter[t].artnr.indexOf(e)?HalterFilter.halter[t].show=!1:HalterFilter.halter[t].show=!0;HalterFilter.createOhneView()},filterMaterialOhneHalter:function(){for(var e=$(this).val(),t=0;t<HalterFilter.halter.length;t++)"choose"!=e&&HalterFilter.halter[t].material!=e?HalterFilter.halter[t].show=!1:HalterFilter.halter[t].show=!0;HalterFilter.createOhneView()},iniActions:function(){var e=this;$("body").on("click","#filter-view",e.showFilterFunction),$("body").on("click","#filter-view-ohne",e.showFilterFunction),$("body").on("click","#close-product-mitB-Filter",e.closeFilterFunction),$("body").on("click","#close-product-ohneB-Filter",e.closeFilterFunction),$("body").on("click",".addFilterHalterMitToAuswahlBtn",e.addHalterToAuswahl),$("body").on("click",".addFilterHalterOhneToAuswahlBtn",e.addHalterToAuswahl),$("body").on("keyup",this.config.mit.filter.artNr.id,e.filterArtNrMitHalter),$("body").on("change",this.config.mit.filter.material.id,e.filterMaterialMitHalter),$("body").on("change",this.config.mit.filter.verwendung.id,e.filterVerwendungMitHalter),$("body").on("keyup",this.config.ohne.filter.artNr.id,e.filterArtNrOhneHalter),$("body").on("change",this.config.ohne.filter.material.id,e.filterMaterialOhneHalter),$("body").on("change",this.config.ohne.filter.verwendung.id,e.filterVerwendungOhneHalter)},closeFilterFunction:function(e){var t="close-product-mitB-Filter"==$(this).attr("id")?!0:!1;t?HalterFilter.onMit&&(HalterFilter.onMit=!1,HalterFilter.hideMitFilter()):HalterFilter.onOhne&&(HalterFilter.onOhne=!1,HalterFilter.hideOhneFilter())},showFilterFunction:function(e,t){if(!API.isset(t))var t="filter-view"==$(this).attr("id")?!0:!1;API.isset(Material.getCurrentConfiguration().size)&&(HalterFilter.initialize(Konfigurator.data.halter,Material.getCurrentConfiguration().size),t?HalterFilter.onMit?(HalterFilter.onMit=!1,HalterFilter.hideMitFilter()):(HalterFilter.onMit=!0,HalterFilter.showMitFilter(),HalterFilter.createMitView(),$("#halter-mitBohrung-AbstandEdit").show()):HalterFilter.onOhne?(HalterFilter.onOhne=!1,HalterFilter.hideOhneFilter()):(HalterFilter.onOhne=!0,HalterFilter.showOhneFilter(),HalterFilter.createOhneView()))},addHalterToAuswahl:function(e){var t=$(this).hasClass("addFilterHalterMitToAuswahlBtn")?!0:!1,n=$(this).parent("div").find('input[name="hId"]').val(),i=$(this).parent("div").find('input[name="vId"]').val(),r=Konfigurator.helper.getHalter(n,i);if(t){$("#view-halterMitBohrung-auswahlHId").val(n),$("#view-halterMitBohrung-variantenId").val(i),$(".view-halterMitBohrung-HalterAuswahlPreview").html(r.variante.name),$(".view-halterMitBohrung-HalterAuswahlMaterial").html(r.variante.material),$(".view-halterMitBohrung-HalterAuswahlArtNr").html(r.variante.artnr),$(".view-halterMitBohrung-HalterAuswahlWand").html(API.dotToComma(r.variante.wandabstand)),$(".view-halterMitBohrung-HalterAuswahlSize").html(0==r.variante.halterkantenlaenge?"&Oslash;"+API.dotToComma(r.variante.durchmesser):API.dotToComma(r.variante.halterkantenlaenge)+" x "+API.dotToComma(r.variante.halterkantenlaenge)),$(".view-halterMitBohrung-HalterAuswahlKopf").html(r.variante.kopfform),$(".view-halterMitBohrung-HalterAuswahlPreis").html(API.priceView(r.variante.preis)),$(".halterMBohrungAuswahl").show(),$(".view-halterMitBohrung-selection").show();var a=Konfigurator.config.halterImgPfad+r.variante.bild,o=Konfigurator.config.halterImgPfad+Konfigurator.helper.getMiniImgData("path")+Konfigurator.helper.getMiniImgData("name",r.variante.bild);$(".view-halterMitBohrung-Img").attr("href",a).show(),$(".view-halterMitBohrung-Img-preview").attr("src",o)}else{$("#view-halterOhneBohrung-auswahlHId").val(n),$("#view-halterOhneBohrung-variantenId").val(i),$(".view-halterOhneBohrung-HalterAuswahlPreview").html(r.variante.name),$(".view-halterOhneBohrung-HalterAuswahlMaterial").html(r.variante.material),$(".view-halterOhneBohrung-HalterAuswahlArtNr").html(r.variante.artnr),$(".view-halterOhneBohrung-HalterAuswahlWand").html(API.dotToComma(r.variante.wandabstand)),$(".view-halterOhneBohrung-HalterAuswahlSize").html(0==r.variante.halterkantenlaenge?"&Oslash;"+API.dotToComma(r.variante.durchmesser):API.dotToComma(r.variante.halterkantenlaenge)+" x "+API.dotToComma(r.variante.halterkantenlaenge)),$(".view-halterOhneBohrung-HalterAuswahlKopf").html(r.variante.kopfform),$(".view-halterOhneBohrung-HalterAuswahlPreis").html(API.priceView(r.variante.preis)),$(".halterOBohrungAuswahl").show(),$(".view-halterOhneBohrung-selection").show();var a=Konfigurator.config.halterImgPfad+r.variante.bild,o=Konfigurator.config.halterImgPfad+Konfigurator.helper.getMiniImgData("path")+Konfigurator.helper.getMiniImgData("name",r.variante.bild);$(".view-halterOhneBohrung-Img").attr("href",a).show(),$(".view-halterOhneBohrung-Img-preview").attr("src",o)}HalterFilter.showFilterFunction(e,t)},showMitFilter:function(){$(this.config.mit.normalerBereich).hide(),$(this.config.mit.filterBereich).show()},hideMitFilter:function(){$(this.config.mit.filterBereich).hide(),$(this.config.mit.normalerBereich).show()},showOhneFilter:function(){$(this.config.ohne.normalerBereich).hide(),$(this.config.ohne.filterBereich).show()},hideOhneFilter:function(){$(this.config.ohne.filterBereich).hide(),$(this.config.ohne.normalerBereich).show()},createMitView:function(){for(var e=this.addContainerHeader(),t=0;t<this.halter.length;t++)this.halter[t].show&&!this.halter[t].kante&&(e+=this.halter[t].html);$(this.config.mit.container).html(e)},createOhneView:function(){for(var e=this.addContainerHeader(),t=0;t<this.halter.length;t++)this.halter[t].show&&this.halter[t].kante&&(e+=this.halter[t].html);$(this.config.ohne.container).html(e)},objToHtml:function(e,t){var n=Konfigurator.config.halterImgPfad,i='<div class="row" style="margin:6px 0 0 0 !important; padding-top: 6px !important; border-top: 1px solid #B4A97F;">';i+='<div class="col-xs-10 col-sm-10 col-md-10 col-lg-10" style="font-size: 11px !important;">',i+='<div class="row" style="margin:0px !important;">',i+='<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">',i+='<input type="hidden" name="vId" value="'+e.uid+'" />',i+='<input type="hidden" name="hId" value="'+t+'" />',i+='<p style="text-align: left; font-size: 12px !important; margin-bottom: 0; font-weight: bold; display: inline-block;">'+e.name+'</p><span class="sprite-Bestaetigen addFilterHalter'+("kante"==e.position?"Ohne":"Mit")+'ToAuswahlBtn" style="display: inline-block;"></span>',i+='<p style="text-align: left; font-size: 12px !important; margin-bottom: 0;">'+e.material+"<br /> Preis: "+API.priceView(e.preis)+" &euro;</p>",i+="</div>",i+="</div>",i+='<div class="row" style="margin:0px !important;">',i+='<div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">',i+="Art.Nr.:",i+="</div>",i+='<div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">',i+="Wandabst.:",i+="</div>",i+='<div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">',i+="Gr&ouml;&szlig;e:",i+="</div>",i+='<div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">',i+="Kopfform:",i+="</div>",i+="</div>",i+='<div class="row" style="margin:0px !important;">',i+='<div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">',i+=e.artnr,i+="</div>",i+='<div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">',i+=e.wandabstand,i+="</div>",i+='<div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">',i+=0!=e.halterkantenlaenge?e.halterkantenlaenge+" x "+e.halterkantenlaenge+" mm":"&oslash; "+e.durchmesser+"mm",i+="</div>",i+='<div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">',i+=e.kopfform,i+="</div>",i+="</div>",i+="</div>",i+='<div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">';var r=n+e.bild,a=n+Konfigurator.helper.getMiniImgData("path")+Konfigurator.helper.getMiniImgData("name",e.bild);i+='<a href="'+r+'" data-lightbox="halterMBohrung" data-title="'+e.name+" - "+e.material+'">',i+='<img class="img-responsive" src="'+a+'" style="margin-top: 8px !important;">',i+="</a>",i+="</div>",i+="</div>",this.halter.push({show:!0,artnr:e.artnr,material:e.material,wa:e.wandabstand,verwendung:e.beschreibung,html:i,kante:"kante"==e.position?!0:!1})},addContainerHeader:function(){var e='<div class="row" style="padding: 0 !important; margin: 6px 0 !important; color: #998B55; ">';return e+='<div class="col-xs-10 col-sm-10 col-md-10 col-lg-10" style="padding: 0 !important; text-align: left;">',e+="Halter",e+="</div>",e+='<div class="col-xs-2 col-sm-2 col-md-2 col-lg-2" style="padding: 0 !important; text-align: right;">',e+="Bild",e+="</div>",e+="</div>"}},View={initializeFrontEnd:function(){InputFieldTest.start(),this.Configuration.createView.initialize(),this.Bearbeitungen.Kanten.createKantenAuswahl(),this.Bearbeitungen.Ecken.createEckBearbeitungAuswahl(),this.Bearbeitungen.Ecken.createEckSelectionView(),this.Bearbeitungen.Ecken.createSelectionView(),this.Bearbeitungen.Ecken.createEckSelectionView(),this.Bearbeitungen.Ecken.createSelectionView(),this.Bearbeitungen.Bohrungen.iniBohrungView(),this.Bearbeitungen.Bohrungen.createEckSelectionView(),this.Bearbeitungen.Bohrungen.createSelectionView(),this.Bearbeitungen.Senkungen.iniSenkungView(),this.Bearbeitungen.Senkungen.createEckSelectionView(),this.Bearbeitungen.Senkungen.createSelectionView(),this.Bearbeitungen.Senkungen.createSchraubenMView(),this.Halter.mitBohrung.createEckSelectionView(),this.Halter.mitBohrung.createSelectionView(),this.Halter.ohneBohrung.createSelectionView()},actions:{initializeFirst:function(){this.Configuration.initialize(),this.Material.initialize(),this.Bearbeitungen.initialize(),this.Halter.initialize()},Configuration:{initialize:function(){$("body").on("click","#addToCartBtn",View.actions.Configuration.addToCartFunction),$("body").on("click","#addToCartMobileBtn",View.actions.Configuration.addToCartFunction),$("body").on("click","#editCartBtn",View.actions.Configuration.editCartFunction),$("body").on("click","#editCartMobileBtn",View.actions.Configuration.editCartFunction),$("body").on("click","#minusQtyBtn",View.actions.Configuration.minusQtyFunction),$("body").on("click","#plusQtyBtn",View.actions.Configuration.plusQtyFunction),$("body").on("keyup","#view-configuration-qty",View.actions.Configuration.checkEnteredQtyFunction),$("body").on("keyup","#view-configuration-width",View.actions.Configuration.drawImgFunction),$("body").on("keyup","#view-configuration-height",View.actions.Configuration.drawImgFunction),$("body").on("click","#configuration-tempern",View.actions.Configuration.clickTempernFunction),$("body").on("click",".bearbeitungHeader",View.actions.Configuration.closeAccordionFunction),$("body").on("click","#back-to-Top-Lnk",View.actions.Configuration.backToTopFunction),$("body").on("click","#show-mobile-img-btn",View.actions.Configuration.showMobileCADFunction)},clickTempernFunction:function(e){Bearbeitungen.Tempern.current.tempern?Bearbeitungen.Tempern.setTempern(!1):Bearbeitungen.Tempern.setTempern(!0),Validate.materialSet()&&Price.createPriceView()},showMobileCADFunction:function(e){e.preventDefault(),$("#mobile-img-area").toggle("fast",function(){var e=$("#show-mobile-img-btn").find("img");"typo3conf/ext/glshop/Resources/Public/Img/CAD.png"==e.attr("src")?e.attr("src","typo3conf/ext/glshop/Resources/Public/Img/CAD_open.png"):e.attr("src","typo3conf/ext/glshop/Resources/Public/Img/CAD.png")})},backToTopFunction:function(e){e.preventDefault();var t=$(this).attr("href");$("html, body").animate({scrollTop:$(t).offset().top},"slow")},closeAccordionFunction:function(e){e.preventDefault();var t=$(this).next("div.panel-group");return t.find("div.panel-collapse.in").removeClass("in"),!1},drawImgFunction:function(e){e.preventDefault();var t=$("#view-configuration-width"),n=$("#view-configuration-height"),i=$("#view-configuration-qty").val(),r=t.parent("div").parent("div").parent("div").parent("div").find("div.error"),a=!0;a=a&&Validate.checkRegexp(t,r),a=a&&Validate.checkRegexp(n,r),a=a&&Validate.material(t,n,r),a&&(Grundeinstellung.setHeight(n.val()).setWidth(t.val()).setQty(i),$("#view-konfigurator-img").show(),Konfigurator.helper.drawCADImg(),View.Configuration.createView.insertGrundEinstellungenView()),Validate.materialSet()&&Price.createPriceView()},saveImgToServer:function(e){var t="";$("#"+e).getCanvasImage("png");return t},editCartFunction:function(e){e.preventDefault();var t=Konfigurator.getDataForCart(),n=!1,i=$("#view-konfigurator-img").getCanvasImage("png"),r=Price.calculate(),a=new Object;a.eID="ajaxDispatcher",a.request={pluginName:"Glacrylshop",controller:"Aj",action:"addToCart",arguments:{artikel:t,anzahl:t.materialConfig.qty,img:i,preis:r,posNr:Konfigurator.data.edit.posNr,schild:!0}};var n=API.ajax(!1,a,"POST","json");n?(t.materialConfig.qty>Validate.config.maxQty?($("#konfigurator-qty-warning").html(t.materialConfig.qty),$("#konfigurator-qty-Dialog").dialog("open")):$("#konfigurator-success-Dialog").dialog("open"),Konfigurator.data.edit=null,Konfigurator.resetKonfiguratorView(),View.Configuration.createView.insertGrundEinstellungenView()):$("#konfigurator-error-Dialog").dialog("open"),$("#konfigurator-img-mobile").is(":visible")&&$("#show-mobile-img-btn").trigger("click")},addToCartFunction:function(e){e.preventDefault();var t=Konfigurator.getDataForCart(),n=!1,i=$("#view-konfigurator-img").getCanvasImage("png"),r=Price.calculate(),a=new Object;a.eID="ajaxDispatcher",a.request={pluginName:"Glacrylshop",controller:"Aj",action:"addToCart",arguments:{artikel:t,anzahl:t.materialConfig.qty,img:i,preis:r,schild:!0}};var n=API.ajax(!1,a,"POST","json");n?(t.materialConfig.qty>Validate.config.maxQty?($("#konfigurator-qty-warning").html(t.materialConfig.qty),$("#konfigurator-qty-Dialog").dialog("open")):$("#konfigurator-success-Dialog").dialog("open"),Konfigurator.resetKonfiguratorView()):$("#konfigurator-error-Dialog").dialog("open"),$("#konfigurator-img-mobile").is(":visible")&&$("#show-mobile-img-btn").trigger("click")},checkEnteredQtyFunction:function(e){e.preventDefault();var t=parseInt($(this).val()),n=!0,i=$(this).parent("div").parent("div").parent("div").parent("div").find("div.error");if(n=n&&Validate.emptyField({"St&uuml;ckzahl":$(this)},i),n=n&&Validate.checkRegexp($(this),i),n=n&&Validate.checkNumber($(this),i)){Grundeinstellung.setQty(t),Price.createPriceView();var r=Konfigurator.prepareDataForImg(),a=r.material,o=r.materialConfig,l=parseFloat(o.height)*parseFloat(o.width)/1e6*1.2*parseFloat(a.size)*t,u='<input type="checkbox" id="configuration-tempern">+'+API.priceView(Price.getTemperPrice(parseInt(t),l))+"€";$("#view-configuration-tempern span label").html(u);var h=Bearbeitungen.Tempern.getCurrentConfiguration();h.tempern&&$("#configuration-tempern").prop("checked",!0)}},minusQtyFunction:function(e){e.preventDefault();var t=$("#view-configuration-qty"),n=parseInt(t.val()),i=1,r=!0,a=t.parent("div").parent("div").parent("div").parent("div").find("div.error");if(r=r&&Validate.emptyField({"St&uuml;ckzahl":t},a),r=r&&Validate.checkRegexp(t,a),r=r&&Validate.checkNumber(t,a)){n>1&&(i=--n),Grundeinstellung.setQty(i),$("#view-configuration-qty").val(i),Price.createPriceView();var o=Konfigurator.prepareDataForImg(),l=o.material,u=o.materialConfig,h=parseFloat(u.height)*parseFloat(u.width)/1e6*1.2*parseFloat(l.size)*i,c='<input type="checkbox" id="configuration-tempern">+'+API.priceView(Price.getTemperPrice(parseInt(i),h))+"€";$("#view-configuration-tempern span label").html(c);var s=Bearbeitungen.Tempern.getCurrentConfiguration();s.tempern&&$("#configuration-tempern").prop("checked",!0)}},plusQtyFunction:function(e){e.preventDefault();var t=$("#view-configuration-qty"),n=parseInt(t.val()),i=!0,r=t.parent("div").parent("div").parent("div").parent("div").find("div.error");if(i=i&&Validate.emptyField({"St&uuml;ckzahl":t},r),i=i&&Validate.checkRegexp(t,r),i=i&&Validate.checkNumber(t,r,!0)){99999==n?n=n:n++,Grundeinstellung.setQty(n),$("#view-configuration-qty").val(n),Price.createPriceView();var a=Konfigurator.prepareDataForImg(),o=a.material,l=a.materialConfig,u=parseFloat(l.height)*parseFloat(l.width)/1e6*1.2*parseFloat(o.size)*n,h='<input type="checkbox" id="configuration-tempern">+'+API.priceView(Price.getTemperPrice(parseInt(n),u))+"€";$("#view-configuration-tempern span label").html(h);var c=Bearbeitungen.Tempern.getCurrentConfiguration();c.tempern&&$("#configuration-tempern").prop("checked",!0)}}},Material:{initialize:function(){$("body").on("change","#view-material-auswahl div div div.panel-body select",View.actions.Material.changeMaterialFunction),$("body").on("click",".addMaterialBtn",View.actions.Material.addMaterialFunction)},changeMaterialFunction:function(e){e.preventDefault();var t=$(this).parent("div").find('input[name="materialUid"]').val(),n=$(this).val(),i=$(this).parent("div").parent("div").attr("id").split("_");Material.setVariante(n),View.Material.changeSizeView(i[2],t,n);for(var r=Konfigurator.data.material,a=Konfigurator.config.materialImgPfad,o=0;o<r.length;o++)if(parseInt(t)==parseInt(r[o].uid))for(var l=0;l<r[o].varianten.length;l++)parseInt(n)==parseInt(r[o].varianten[l].uid)&&(a+=r[o].varianten[l].bild);$(this).parent("div").find("div.row").find("div.materialImg").find("img").attr("src",a),$(this).parent("div").find("div.row").find("div.materialImg").find("a").attr("href",a)},addMaterialFunction:function(e){var t=$("#view-material-auswahl").find("div.in"),n=t.find("div").find('input[name="materialUid"]').val(),i=API.isset(t.find("div").find("select").val())?t.find("div").find("select").val():t.find("div").find('input[name="variantenUid"]').val(),r=t.find("div").find("div.row").find("div:first").find('input[name="dicke"]:checked'),a=r.val(),o=$("#view-configuration-width"),l=$("#view-configuration-height"),u=t.find("div.error"),h=!0;if(h=h&&Validate.emptyField({Breite:o,"H&ouml;he":l},u)){Material.setMaterial(n).setVariante(i).setSize(a),Material.checkedVariante=r,View.Bearbeitungen.Kanten.createKantenAuswahl();var c=Bearbeitungen.Kanten.getCurrentConfiguration();3==n&&(2==c.uid||4==c.uid)&&$("#view-kanten-auswahl select").val(1),View.actions.Bearbeitungen.changeAndSaveKantenAuswahlFunction(),Halter.checkConfiguration(),View.Configuration.createView.insertMaterialView(),Price.createPriceView(),$("#view-configuration-priceview").show();var s=Konfigurator.prepareDataForImg(),t=s.material,g=s.materialConfig,d=parseInt(Grundeinstellung.getCurrentConfiguration().qty),f=parseFloat(g.height)*parseFloat(g.width)/1e6*1.2*parseFloat(t.size)*d,v='<input type="checkbox" id="configuration-tempern">+'+API.priceView(Price.getTemperPrice(parseInt(d),f))+"€";$("#view-configuration-tempern span label").html(v);var p=Bearbeitungen.Tempern.getCurrentConfiguration();p.tempern&&$("#configuration-tempern").prop("checked",!0),Dispatcher.clearErrorFields(Dispatcher.Type.Halter).clearErrorFields(Dispatcher.Type.Bearbeitung),API.MobileCheck()?$("#mobile-footer-data").show():$("#mobile-footer-data").hide(),API.isset(Konfigurator.data.edit.article)||($("#editCartBtn").hide(),$("#editCartMobileBtn").hide(),$("#addToCartBtn").show(),$("#addToCartMobileBtn").show()),Tooltips.initialize()}else e.preventDefault()}},Bearbeitungen:{initialize:function(){$("body").on("change","#view-kanten-auswahl select",View.actions.Bearbeitungen.changeAndSaveKantenAuswahlFunction),
$("body").on("keyup","#view-kanten-facette",View.actions.Bearbeitungen.addFacetteKantenFunction),$("body").on("change","#view-kanten-angle",View.actions.Bearbeitungen.changeKantenAngleFunction),$("body").on("click",'#eckenAuswahlBox button[name="eckenAuswahlBox"]',View.actions.Bearbeitungen.eckenAuswahlFunction),$("body").on("tap","#eckenCheckBox label",API.markEckenCheckbox),$("body").on("click","#view-addEckXY",View.actions.Bearbeitungen.addSchraegeEckeFunction),$("body").on("click","#view-addEckRadius",View.actions.Bearbeitungen.addRundeEckeFunction),$("body").on("click",".editEckenBtn",View.actions.Bearbeitungen.editEckenFunction),$("body").on("click",".deleteEckenBtn",View.actions.Bearbeitungen.deleteEditEckenFunction),$("body").on("click",".acceptEckenBtn",View.actions.Bearbeitungen.acceptEditEckenFunction),$("body").on("tap","#bohrungenCheckBox label",API.markEckenCheckbox),$("body").on("click",".editBohrungenBtn",View.actions.Bearbeitungen.editBohrungenFunction),$("body").on("click",".deleteBohrungenBtn",View.actions.Bearbeitungen.deleteEditBohrungenFunction),$("body").on("click",".acceptBohrungenBtn",View.actions.Bearbeitungen.acceptEditBohrungenFunction),$("body").on("click","#addBohrungenBtn",View.actions.Bearbeitungen.addBohrungFunction),$("body").on("tap","#senkungenCheckBox label",API.markEckenCheckbox),$("body").on("click",".editSenkungenBtn",View.actions.Bearbeitungen.editSenkungenFunction),$("body").on("click",".deleteSenkungenBtn",View.actions.Bearbeitungen.deleteEditSenkungenFunction),$("body").on("click",".acceptSenkungenBtn",View.actions.Bearbeitungen.acceptEditSenkungenFunction),$("body").on("click","#addSenkungenBtn",View.actions.Bearbeitungen.addSenkungFunction)},deleteEditEckenFunction:function(e){e.preventDefault();var t=$(this).parent("td").parent("tr").find("td:first").text();Bearbeitungen.Ecken.removeConfiguration(t),View.Bearbeitungen.Ecken.createEckSelectionView(),View.Bearbeitungen.Ecken.createSelectionView(),View.Configuration.createView.insertEckenView(),Price.createPriceView(),Konfigurator.helper.drawCADImg()},acceptEditEckenFunction:function(e){e.preventDefault();var t=$(this).parent("td").parent("tr").find("td"),n=0,i=0,r=0,a="",o=0,l="";$.each(t,function(e){0==e?(a=$(this).find("select").val(),l=$(this).find("input[type=hidden]").val()):1==e?(n=$(this).find("input").val(),(""==n||" - "==n||0==Number(n))&&(n=null)):2==e?(i=$(this).find("input").val(),(""==i||" - "==i||0==Number(i))&&(i=null)):3==e?(r=$(this).find("input").val(),(""==r||" - "==r||0==Number(r))&&(r=null)):4==e&&($(this).find(".editEckenBtn").show(),$(this).find(".deleteEckenBtn").show(),$(this).find(".acceptEckenBtn").hide())});var u=Bearbeitungen.Kanten.getCurrentConfiguration(),h=!0;null!=r?(o=2,n=null,i=null,h=2==u.uid||4==u.uid?!0:!1):o=1,h&&Bearbeitungen.Ecken.editConfiguration(o,a,r,n,i,l),View.Bearbeitungen.Ecken.createEckSelectionView(),View.Bearbeitungen.Ecken.createSelectionView(),View.Configuration.createView.insertEckenView(),Price.createPriceView(),Konfigurator.helper.drawCADImg()},editEckenFunction:function(e){e.preventDefault();var t=Bearbeitungen.Ecken.corner,n=["E1","E2","E3","E4"],i=$(this).parent("td").parent("tr").find("td");$.each(i,function(e){if(0==e){for(var i=$(this).text(),r="<select>",e=0;e<n.length;e++)n[e]!=i&&t.isCornerSet(n[e])||(r+="<option "+(n[e]==i?"selected":"")+' value="'+n[e]+'">'+n[e]+"</option>");r+="</select>",r+='<input type="hidden" maxlength="4" value="'+i+'" />',$(this).html(r)}else if(4==e)$(this).find(".acceptEckenBtn").show(),$(this).find(".editEckenBtn").hide(),$(this).find(".deleteEckenBtn").hide();else if(4!=e){var i=$(this).text(),r='<input type="text" maxlength="4" value="'+i+'" />';$(this).html(r)}}),$("#view-eckbearbeitung-x").val(""),$("#view-eckbearbeitung-y").val(""),$("#view-eckbearbeitung-radius").val("")},deleteEditBohrungenFunction:function(e){e.preventDefault();var t=$(this).parent("td").parent("tr").find("td:first").find("input[type=hidden]").val(),n=Halter.getHalterByBohrIndex(t);API.isset(n)&&(Halter.removeConfiguration(n.index),View.Halter.mitBohrung.createEckSelectionView(),View.Halter.mitBohrung.createSelectionView(),View.Configuration.createView.insertHalterView()),Bearbeitungen.Bohrungen.removeConfiguration(t),View.Bearbeitungen.Bohrungen.createEckSelectionView(),View.Bearbeitungen.Bohrungen.createSelectionView(),View.Configuration.createView.insertBohrungView(),Price.createPriceView(),Konfigurator.helper.drawCADImg()},acceptEditBohrungenFunction:function(e){e.preventDefault();var t=$(this).parent("td").parent("tr").find("td"),n=0,i=0,r=0,a="",o="";$.each(t,function(e){0==e?(a=$(this).find("select").val(),o=$(this).find("input[type=hidden]").val()):1==e?n=$(this).find("input").val():2==e?i=$(this).find("input").val():3==e?r=API.commaToDot($(this).find("input").val()):4==e&&($(this).find(".editBohrungenBtn").show(),$(this).find(".deleteBohrungenBtn").show(),$(this).find(".acceptBohrungenBtn").hide())});var l=Halter.getHalterByBohrIndex(o);API.isset(l)&&(Halter.editConfiguration(l.index,l.hid,l.vid,a,n,i,null,o),View.Halter.mitBohrung.createEckSelectionView(),View.Halter.mitBohrung.createSelectionView(),View.Configuration.createView.insertHalterView()),Bearbeitungen.Bohrungen.editConfiguration(o,1,a,r,n,i),View.Bearbeitungen.Bohrungen.createEckSelectionView(),View.Bearbeitungen.Bohrungen.createSelectionView(),View.Configuration.createView.insertBohrungView(),Price.createPriceView(),Konfigurator.helper.drawCADImg()},editBohrungenFunction:function(e){e.preventDefault();var t=Bearbeitungen.Bohrungen.corner,n=["E1","E2","E3","E4","FREI"],i=$(this).parent("td").parent("tr").find("td"),r=null;$.each(i,function(e){if(0==e){var i=$(this).find("span").text();r=$(this).find("input[type=hidden]").val();for(var a="<select>",e=0;e<n.length;e++)n[e]!=i&&t.isCornerSet(n[e])||(a+="<option "+(n[e]==i?"selected":"")+' value="'+n[e]+'">'+n[e]+"</option>");a+="</select>",a+='<input type="hidden" value="'+r+'" />',$(this).html(a)}else if(4==e)$(this).find(".acceptBohrungenBtn").show(),$(this).find(".editBohrungenBtn").hide(),$(this).find(".deleteBohrungenBtn").hide();else if(4!=e){var i=$(this).text(),a='<input type="text" maxlength="4" value="'+i+'" />';$(this).html(a)}});var a=Halter.getHalterByBohrIndex(r);API.isset(a)&&$.each(i,function(e){3==e&&$(this).find("input").attr("disabled","disabled")}),$("#view-bohrungen-d").val(""),$("#view-bohrungen-x").val(""),$("#view-bohrungen-y").val("")},deleteEditSenkungenFunction:function(e){e.preventDefault();var t=$(this).parent("td").parent("tr").find("td:first").find("input[type=hidden]").val(),n=Halter.getHalterByBohrIndex(t);API.isset(n)&&(Halter.removeConfiguration(n.index),View.Halter.mitBohrung.createEckSelectionView(),View.Halter.mitBohrung.createSelectionView(),View.Configuration.createView.insertHalterView()),Bearbeitungen.Senkungen.removeConfiguration(t),View.Bearbeitungen.Senkungen.createEckSelectionView(),View.Bearbeitungen.Senkungen.createSelectionView(),View.Configuration.createView.insertSenkungView(),Price.createPriceView(),Konfigurator.helper.drawCADImg()},acceptEditSenkungenFunction:function(e){e.preventDefault();var t=$(this).parent("td").parent("tr").find("td"),n=0,i=0,r=0,a="",o="";$.each(t,function(e){0==e?(a=$(this).find("select").val(),o=$(this).find("input[type=hidden]").val()):1==e?n=$(this).find("input").val():2==e?i=$(this).find("input").val():3==e?r=$(this).find("select").val():4==e&&($(this).find(".editSenkungenBtn").show(),$(this).find(".deleteSenkungenBtn").show(),$(this).find(".acceptSenkungenBtn").hide())});var l=Halter.getHalterByBohrIndex(o);API.isset(l)&&(Halter.editConfiguration(l.index,l.hid,l.vid,a,n,i,null,o),View.Halter.mitBohrung.createEckSelectionView(),View.Halter.mitBohrung.createSelectionView(),View.Configuration.createView.insertHalterView()),Bearbeitungen.Senkungen.editConfiguration(o,2,a,r,n,i),View.Bearbeitungen.Senkungen.createEckSelectionView(),View.Bearbeitungen.Senkungen.createSelectionView(),View.Configuration.createView.insertSenkungView(),Price.createPriceView(),Konfigurator.helper.drawCADImg()},editSenkungenFunction:function(e){e.preventDefault();var t=Bearbeitungen.Senkungen.corner,n=["E1","E2","E3","E4","FREI"],i=Konfigurator.data.senkungen,r=$(this).parent("td").parent("tr").find("td"),a=null;$.each(r,function(e){if(0==e){var r=$(this).find("span").text();a=$(this).find("input[type=hidden]").val();for(var o="<select>",e=0;e<n.length;e++)n[e]!=r&&t.isCornerSet(n[e])||(o+="<option "+(n[e]==r?"selected":"")+' value="'+n[e]+'">'+n[e]+"</option>");o+="</select>",o+='<input type="hidden" value="'+a+'" />',$(this).html(o)}else if(3==e){for(var r=$(this).text(),o="<select>",e=0;e<i.length;e++)o+="<option "+(parseInt(r)==parseInt(i[e].gewinde)?"selected":"")+' value="'+parseInt(i[e].gewinde)+'">'+parseInt(i[e].gewinde)+"</option>";o+="</select>",$(this).html(o)}else if(4==e)$(this).find(".acceptSenkungenBtn").show(),$(this).find(".editSenkungenBtn").hide(),$(this).find(".deleteSenkungenBtn").hide();else if(4!=e){var r=$(this).text(),o='<input type="text" maxlength="4" value="'+r+'" />';$(this).html(o)}});var o=Halter.getHalterByBohrIndex(a);API.isset(o)&&$.each(r,function(e){3==e&&$(this).find("select").attr("disabled","disabled")}),$("#view-senkungen-x").val(""),$("#view-senkungen-y").val("")},changeKantenAngleFunction:function(e){e.preventDefault(),$("#view-kanten-facette").val("")},changeAndSaveKantenAuswahlFunction:function(e){API.isset(e)&&e.preventDefault();var t=Konfigurator.config.bearbeitungImgPfad,n=Konfigurator.data.kanten,i="",r="",a=parseInt($("#view-kanten-auswahl select").val()),o=$("#view-configuration-width"),l=$("#view-configuration-height"),u=o.parent("div").parent("div").parent("div").parent("div").find("div.error"),h=Validate.material(o,l,u,a);if(h){Grundeinstellung.setWidth(o.val()).setHeight(l.val()),View.Configuration.createView.insertGrundEinstellungenView();for(var c=Bearbeitungen.Ecken.getCurrentConfiguration(),s=!0,g=[],d=0;d<c.length;d++)API.isset(c[d].uid)&&(Konfigurator.helper.isEckeForKanteEnabled(c[d].uid,a)||(s=!1,g.push(c[d])));if(s){if(6==a){$("#view-facetten-eigenschaften").show(),$("#view-kanten-eigenschaften").hide();for(var d=0;d<n.length;d++)parseInt(n[d].uid)==a&&(i=t+n[d].bild,r=t+Konfigurator.helper.getMiniImgData("path")+Konfigurator.helper.getMiniImgData("name",n[d].bild));$("#view-facceten-img-preview").attr("src",r),$("#view-facceten-img").attr("href",i);var f=Konfigurator.data.edit;API.isset(f)&&API.isset(f.article)&&API.isset(f.article.bearbeitungen.kanten.facette)&&(Bearbeitungen.Kanten.setBearbeitung(f.article.bearbeitungen.kanten.uid),Bearbeitungen.Kanten.setFacette(f.article.bearbeitungen.kanten.facette),Bearbeitungen.Kanten.setAngle(f.article.bearbeitungen.kanten.angle),$("#view-kanten-facette").val(f.article.bearbeitungen.kanten.facette),$("#view-kanten-angle").val(f.article.bearbeitungen.kanten.angle),View.Configuration.createView.insertKantenView(),Price.createPriceView())}else{$("#view-facetten-eigenschaften").hide(),$("#view-kanten-eigenschaften").show();for(var d=0;d<n.length;d++)parseInt(n[d].uid)==a&&(i=t+n[d].bild,r=t+Konfigurator.helper.getMiniImgData("path")+Konfigurator.helper.getMiniImgData("name",n[d].bild));$("#view-kanten-img-preview").attr("src",r),$("#view-kanten-img").attr("href",i),Bearbeitungen.Kanten.setBearbeitung(a),Bearbeitungen.Kanten.setFacette(null),Bearbeitungen.Kanten.setAngle(null),View.Configuration.createView.insertKantenView(),Price.createPriceView(),$("#view-kanten-facette").val(""),$("#view-kanten-angle").val("45")}View.Bearbeitungen.Ecken.createEckBearbeitungAuswahl(),$(".view-eckbearbeitung-rund").hide(),$("#view-ecken-img").hide(),Konfigurator.helper.drawCADImg()}else Dispatcher.transition.ecken=g,$("#konfigurator-changeKanten-Dialog").dialog("open")}else{var n=Bearbeitungen.Kanten.getCurrentConfiguration();$(this).val(n.uid),$("#konfigurator-changeKante-sizeInfo-Dialog").dialog("open")}},addFacetteKantenFunction:function(e){e.preventDefault();var t=$("#view-kanten-auswahl select").val(),n=$("#view-kanten-facette"),i=$("#view-kanten-angle").val(),r=n.parent("div").parent("div").parent("div").find("div.error"),a=!0;a=a&&Validate.materialSet(r),a||Dispatcher.addErrorField(Dispatcher.Type.Bearbeitung,r),a=a&&Validate.checkRegexp(n,r),a=a&&Validate.checkFacettenEingabe(n,i,!1,r),a&&(Bearbeitungen.Kanten.setBearbeitung(t),null!=n&&""!=i&&Bearbeitungen.Kanten.setAngle(i).setFacette(n.val()),View.Configuration.createView.insertKantenView(),Price.createPriceView(),Konfigurator.helper.drawCADImg())},eckenAuswahlFunction:function(e){e.preventDefault(),$(this).addClass("active").siblings().removeClass("active");var t=$(this).val();switch(t){case"1":$(".view-eckbearbeitung-schraeg").show(),$(".view-eckbearbeitung-rund").hide();break;case"2":$(".view-eckbearbeitung-rund").show(),$(".view-eckbearbeitung-schraeg").hide()}$("#selectedEckBearbeitung").val(t);for(var n=Konfigurator.data.ecken,i=Konfigurator.config.bearbeitungImgPfad,r="",a="",o=0;o<n.length;o++)parseInt(n[o].uid)==parseInt(t)&&(r=i+n[o].bild,a=i+Konfigurator.helper.getMiniImgData("path")+Konfigurator.helper.getMiniImgData("name",n[o].bild));$("#view-ecken-img").show().attr("href",r),$("#view-ecken-img-preview").show().attr("src",a)},addSchraegeEckeFunction:function(e){e.preventDefault();var t=$("#selectedEckBearbeitung").val(),n=$("#view-eckbearbeitung-x"),i=$("#view-eckbearbeitung-y"),r=$("#eckenCheckBox"),a=r.find("label.active input"),o=r.parent("div").parent("div").parent("div").find("div.error"),l=!0;l=l&&Validate.materialSet(o),l||Dispatcher.addErrorField(Dispatcher.Type.Bearbeitung,o),l=l&&Validate.isCheckboxSelected(r,o),l=l&&Validate.checkRegexp(n,o),l=l&&Validate.checkRegexp(i,o),l&&($.each(a,function(e,r){var a=$(r).val();if("ALLE"!=a){var o=$(r).parent("label").attr("disabled");API.isset(o)||Bearbeitungen.Ecken.addConfiguration(t,a,null,n.val(),i.val())}}),View.Configuration.createView.insertEckenView(),View.Bearbeitungen.Ecken.createEckSelectionView(),View.Bearbeitungen.Ecken.createSelectionView(),Price.createPriceView(),Konfigurator.helper.drawCADImg())},addRundeEckeFunction:function(e){e.preventDefault();var t=$("#selectedEckBearbeitung").val(),n=null,i=null,r=$("#eckenCheckBox"),a=r.find("label.active input"),o=$("#view-eckbearbeitung-radius"),l=r.parent("div").parent("div").parent("div").find("div.error"),u=!0;u=u&&Validate.materialSet(l),u||Dispatcher.addErrorField(Dispatcher.Type.Bearbeitung,l),u=u&&Validate.isCheckboxSelected(r,l),u=u&&Validate.checkRegexp(o,l),u=u&&Validate.checkEckRadius(o,!1,l),u&&($.each(a,function(e,r){var a=$(r).val();if("ALLE"!=a){var l=$(r).parent("label").attr("disabled");API.isset(l)||Bearbeitungen.Ecken.addConfiguration(t,a,o.val(),n,i)}}),View.Configuration.createView.insertEckenView(),View.Bearbeitungen.Ecken.createEckSelectionView(),View.Bearbeitungen.Ecken.createSelectionView(),Price.createPriceView(),Konfigurator.helper.drawCADImg())},addBohrungFunction:function(e){e.preventDefault();var t=$("#view-bohrungen-d"),n=$("#view-bohrungen-x"),i=$("#view-bohrungen-y"),r=$("#bohrungenCheckBox"),a=r.find("label.active input"),o=r.parent("div").parent("div").parent("div").find("div.error"),l=!0;l=l&&Validate.materialSet(o),l||Dispatcher.addErrorField(Dispatcher.Type.Bearbeitung,o),l=l&&Validate.isCheckboxSelected(r,o),l=l&&Validate.checkRegexp(t,o,"float"),l=l&&Validate.checkRegexp(n,o),l=l&&Validate.checkRegexp(i,o),l&&($.each(a,function(e,r){var a=$(r).val();if("ALLE"!=a){var o=$(r).parent("label").attr("disabled");API.isset(o)||Bearbeitungen.Bohrungen.addConfiguration(1,a,API.commaToDot(t.val()),n.val(),i.val())}}),View.Configuration.createView.insertBohrungView(),View.Bearbeitungen.Bohrungen.createEckSelectionView(),View.Bearbeitungen.Bohrungen.createSelectionView(),Price.createPriceView(),Konfigurator.helper.drawCADImg())},addSenkungFunction:function(e){e.preventDefault();for(var t=$("#view-senkungen-m").val(),n=$("#view-senkungen-x"),i=$("#view-senkungen-y"),r=0,a=0,o=$("#senkungenCheckBox"),l=o.find("label.active input"),u=Konfigurator.data.senkungen,h=o.parent("div").parent("div").parent("div").find("div.error"),c=0;c<u.length;c++)parseFloat(u[c].gewinde)==parseFloat(t)&&(r=parseFloat(u[c].bohrung),a=parseFloat(u[c].senkung));var s=!0;s=s&&Validate.materialSet(h),s||Dispatcher.addErrorField(Dispatcher.Type.Bearbeitung,h),s=s&&Validate.isCheckboxSelected(o,h),s=s&&Validate.checkRegexp(n,h),s=s&&Validate.checkRegexp(i,h),s&&($.each(l,function(e,o){var l=$(o).val();if("ALLE"!=l){var u=$(o).parent("label").attr("disabled");API.isset(u)||Bearbeitungen.Senkungen.addConfiguration(2,l,t,r,a,n.val(),i.val())}}),View.Configuration.createView.insertSenkungView(),View.Bearbeitungen.Senkungen.createEckSelectionView(),View.Bearbeitungen.Senkungen.createSelectionView(),Price.createPriceView(),Konfigurator.helper.drawCADImg())}},Halter:{initialize:function(){$("body").on("click","#addHalterMitBohrungBtn",View.actions.Halter.addHalterMitBohrungFunction),$("body").on("tap","#halterMitBohrungCheckBox label",API.markEckenCheckbox),$("body").on("click","#editHalterMitBohrungBtn",View.actions.Halter.acceptEditHalterFunction),$("body").on("click","#addHalterOhneBohrungBtn",View.actions.Halter.addHalterOhneBohrungFunction),$("body").on("click","#editHalterOhneBohrungBtn",View.actions.Halter.acceptEditHalterFunction),$("body").on("click",".editHalterBtn",View.actions.Halter.editHalterFunction),$("body").on("click",".deleteHalterBtn",View.actions.Halter.deleteEditHalterFunction),$("body").on("click",".info-halterMit-icon",View.actions.Halter.showHalterMitInfoFunction),$("body").on("click",".info-halterOhne-icon",View.actions.Halter.showHalterOhneInfoFunction),$("body").on("click","#close-detailMitHalter",View.actions.Halter.closeDetailMitHalterFunction),$("body").on("click","#close-detailOhneHalter",View.actions.Halter.closeDetailOhneHalterFunction)},closeDetailMitHalterFunction:function(e){$(".view-halterMitBohrung-HalterAuswahlPreview").html("&nbsp;"),$(".view-halterMitBohrung-HalterAuswahlMaterial").html("&nbsp;"),$(".view-halterMitBohrung-HalterAuswahlArtNr").html("&nbsp;"),$(".view-halterMitBohrung-HalterAuswahlWand").html("&nbsp;"),$(".view-halterMitBohrung-HalterAuswahlSize").html("&nbsp;"),$(".view-halterMitBohrung-HalterAuswahlKopf").html("&nbsp;"),$(".view-halterMitBohrung-HalterAuswahlPreis").html("&nbsp;"),$(".view-halterMitBohrung-selection").hide(),API.isset(Halter.currentEditing)&&(Halter.removeConfiguration(Halter.currentEditing.index),Halter.addConfiguration(Halter.currentEditing.hid,Halter.currentEditing.vid,Halter.currentEditing.corner,Halter.currentEditing.x,Halter.currentEditing.y,Halter.currentEditing.index,Halter.currentEditing.qty,Halter.currentEditing.bohrIndex),View.Halter.mitBohrung.createEckSelectionView(),Halter.currentEditing=null)},closeDetailOhneHalterFunction:function(e){$(".view-halterOhneBohrung-HalterAuswahlPreview").html("&nbsp;"),$(".view-halterOhneBohrung-HalterAuswahlMaterial").html("&nbsp;"),$(".view-halterOhneBohrung-HalterAuswahlArtNr").html("&nbsp;"),$(".view-halterOhneBohrung-HalterAuswahlWand").html("&nbsp;"),$(".view-halterOhneBohrung-HalterAuswahlSize").html("&nbsp;"),$(".view-halterOhneBohrung-HalterAuswahlKopf").html("&nbsp;"),$(".view-halterOhneBohrung-HalterAuswahlPreis").html("&nbsp;"),$(".view-halterOhneBohrung-selection").hide(),API.isset(Halter.currentEditing)&&(Halter.removeConfiguration(Halter.currentEditing.index),Halter.addConfiguration(Halter.currentEditing.hid,Halter.currentEditing.vid,Halter.currentEditing.corner,Halter.currentEditing.x,Halter.currentEditing.y,Halter.currentEditing.index,Halter.currentEditing.qty,Halter.currentEditing.bohrIndex),Halter.currentEditing=null)},showHalterMitInfoFunction:function(e){var t=$(this).parent("td").parent("tr").find("input[type=hidden]").val(),n=Halter.getConfiguration(t),i=Konfigurator.helper.getHalter(n.hid,n.vid);$(".view-halterMitBohrung-HalterAuswahlPreview").html(i.variante.name),$(".view-halterMitBohrung-HalterAuswahlMaterial").html(i.variante.material),$(".view-halterMitBohrung-HalterAuswahlArtNr").html(i.variante.artnr),$(".view-halterMitBohrung-HalterAuswahlWand").html(API.dotToComma(i.variante.wandabstand)),$(".view-halterMitBohrung-HalterAuswahlSize").html(0==i.variante.halterkantenlaenge?"&Oslash;"+API.dotToComma(i.variante.durchmesser):API.dotToComma(i.variante.halterkantenlaenge)+" x "+API.dotToComma(i.variante.halterkantenlaenge)),$(".view-halterMitBohrung-HalterAuswahlKopf").html(i.variante.kopfform),$(".view-halterMitBohrung-HalterAuswahlPreis").html(API.priceView(i.variante.preis));var r=Konfigurator.config.halterImgPfad+i.variante.bild,a=Konfigurator.config.halterImgPfad+Konfigurator.helper.getMiniImgData("path")+Konfigurator.helper.getMiniImgData("name",i.variante.bild);$(".view-halterMitBohrung-Img").attr("href",r).show(),$(".view-halterMitBohrung-Img-preview").attr("src",a),$(".view-halterMitBohrung-selection").show(),$("#halter-mitBohrung-AbstandEdit").hide(),API.isset(Halter.currentEditing)&&(Halter.removeConfiguration(Halter.currentEditing.index),Halter.addConfiguration(Halter.currentEditing.hid,Halter.currentEditing.vid,Halter.currentEditing.corner,Halter.currentEditing.x,Halter.currentEditing.y,Halter.currentEditing.index,Halter.currentEditing.qty,Halter.currentEditing.bohrIndex),View.Halter.mitBohrung.createEckSelectionView(),Halter.currentEditing=null)},showHalterOhneInfoFunction:function(e){var t=$(this).parent("td").parent("tr").find("input[type=hidden]").val(),n=Halter.getConfiguration(t),i=Konfigurator.helper.getHalter(n.hid,n.vid);$(".view-halterOhneBohrung-HalterAuswahlPreview").html(i.variante.name),$(".view-halterOhneBohrung-HalterAuswahlMaterial").html(i.variante.material),$(".view-halterOhneBohrung-HalterAuswahlArtNr").html(i.variante.artnr),$(".view-halterOhneBohrung-HalterAuswahlWand").html(API.dotToComma(i.variante.wandabstand)),$(".view-halterOhneBohrung-HalterAuswahlSize").html(0==i.variante.halterkantenlaenge?"&Oslash;"+API.dotToComma(i.variante.durchmesser):API.dotToComma(i.variante.halterkantenlaenge)+" x "+API.dotToComma(i.variante.halterkantenlaenge)),$(".view-halterOhneBohrung-HalterAuswahlKopf").html(i.variante.kopfform),$(".view-halterOhneBohrung-HalterAuswahlPreis").html(API.priceView(i.variante.preis));var r=Konfigurator.config.halterImgPfad+i.variante.bild,a=Konfigurator.config.halterImgPfad+Konfigurator.helper.getMiniImgData("path")+Konfigurator.helper.getMiniImgData("name",i.variante.bild);$(".view-halterOhneBohrung-Img").attr("href",r).show(),$(".view-halterOhneBohrung-Img-preview").attr("src",a),$(".view-halterOhneBohrung-selection").show(),$("#halter-ohneBohrung-qtyEdit").hide(),API.isset(Halter.currentEditing)&&(Halter.removeConfiguration(Halter.currentEditing.index),Halter.addConfiguration(Halter.currentEditing.hid,Halter.currentEditing.vid,Halter.currentEditing.corner,Halter.currentEditing.x,Halter.currentEditing.y,Halter.currentEditing.index,Halter.currentEditing.qty,Halter.currentEditing.bohrIndex),Halter.currentEditing=null)},deleteEditHalterFunction:function(e){e.preventDefault();var t=$(this).parent("td").parent("tr").find("td:first").find("input[type=hidden]").val(),n=!1,i=Halter.getConfiguration(t);7==parseInt(i.hid)?Bearbeitungen.Senkungen.removeConfiguration(i.bohrIndex):Bearbeitungen.Bohrungen.removeConfiguration(i.bohrIndex),Halter.removeConfiguration(t),3==$(this).parent("td").parent("tr").parent("tbody").parent("table").find("thead>tr>th").length&&(n=!0),n?View.Halter.ohneBohrung.createSelectionView():(View.Halter.mitBohrung.createEckSelectionView(),View.Halter.mitBohrung.createSelectionView()),View.Configuration.createView.insertHalterView(),View.Configuration.createView.insertSenkungView(),View.Configuration.createView.insertBohrungView(),View.Bearbeitungen.Senkungen.createEckSelectionView(),View.Bearbeitungen.Senkungen.createSelectionView(),View.Bearbeitungen.Bohrungen.createEckSelectionView(),View.Bearbeitungen.Bohrungen.createSelectionView(),Price.createPriceView(),Konfigurator.helper.drawCADImg(),$("#editHalterMitBohrungBtn").hide(),$("#addHalterMitBohrungBtn").show(),$(".view-halterMitBohrung-selection").hide(),API.isset(Halter.currentEditing)&&(Halter.currentEditing=null)},acceptEditHalterFunction:function(e){e.preventDefault();var t=!0,n=null,i=null,r=null,a=null,o=null,l=null;if($("#view-halterMitBohrung-x").is(":visible")&&(t=!1),t)l=$("#view-halterOhneBohrung-qty").val(),n=$("#view-halterOhneBohrung-configIndex").val(),i=$("#view-halterOhneBohrung-auswahlHId").val(),r=$("#view-halterOhneBohrung-variantenId").val();else{var u=$("#halterMitBohrungCheckBox"),h=u.find("label.active input").val();n=$("#view-halterMitBohrung-configIndex").val(),i=$("#view-halterMitBohrung-auswahlHId").val(),r=$("#view-halterMitBohrung-variantenId").val(),a=$("#view-halterMitBohrung-x").val(),o=$("#view-halterMitBohrung-y").val()}if(Halter.editConfiguration(n,i,r,h,a,o,l),t?View.Halter.ohneBohrung.createSelectionView():(View.Halter.mitBohrung.createEckSelectionView(),View.Halter.mitBohrung.createSelectionView()),!t)if(parseInt(i)==parseInt(7)){var c=Bearbeitungen.Senkungen.getConfiguration(Halter.getConfiguration(n).bohrIndex);Bearbeitungen.Senkungen.editConfiguration(c.index,c.uid,h,c.m,a,o),View.Bearbeitungen.Senkungen.createEckSelectionView(),View.Bearbeitungen.Senkungen.createSelectionView()}else{var s=Bearbeitungen.Bohrungen.getConfiguration(Halter.getConfiguration(n).bohrIndex),g=Konfigurator.helper.getHalter(i,r);Bearbeitungen.Bohrungen.editConfiguration(s.index,s.uid,h,g.variante.plattenbohrungUnterseite,a,o),View.Bearbeitungen.Bohrungen.createEckSelectionView(),View.Bearbeitungen.Bohrungen.createSelectionView()}View.Configuration.createView.insertHalterView(),View.Configuration.createView.insertSenkungView(),View.Configuration.createView.insertBohrungView(),Price.createPriceView(),Konfigurator.helper.drawCADImg(),t?($("#editHalterOhneBohrungBtn").hide(),$("#addHalterOhneBohrungBtn").show(),$(".view-halterOhneBohrung-selection").hide()):($("#editHalterMitBohrungBtn").hide(),$("#addHalterMitBohrungBtn").show(),$(".view-halterMitBohrung-selection").hide()),API.isset(Halter.currentEditing)&&(Halter.currentEditing=null)},editHalterFunction:function(e){e.preventDefault();var t=!1;3==$(this).parent("td").parent("tr").parent("tbody").parent("table").find("thead>tr>th").length&&(t=!0);var n=$(this).parent("td").parent("tr").find("input[type=hidden]").val(),i=Halter.getConfiguration(n);Halter.currentEditing=i;var r=Konfigurator.helper.getHalter(i.hid,i.vid);if(t){$("#halter-ohneBohrung-qtyEdit").show(),$("#view-halterOhneBohrung-auswahlHId").val(i.hid),$("#view-halterOhneBohrung-variantenId").val(i.vid),$("#view-halterOhneBohrung-configIndex").val(i.index),$("#view-halterOhneBohrung-qty").val(i.qty),$(".view-halterOhneBohrung-HalterAuswahlPreview").html(r.variante.name),$(".view-halterOhneBohrung-HalterAuswahlMaterial").html(r.variante.material),$(".view-halterOhneBohrung-HalterAuswahlArtNr").html(r.variante.artnr),$(".view-halterOhneBohrung-HalterAuswahlWand").html(API.dotToComma(r.variante.wandabstand)),$(".view-halterOhneBohrung-HalterAuswahlSize").html(0==r.variante.halterkantenlaenge?"&Oslash;"+API.dotToComma(r.variante.durchmesser):API.dotToComma(r.variante.halterkantenlaenge)+" x "+API.dotToComma(r.variante.halterkantenlaenge)),$(".view-halterOhneBohrung-HalterAuswahlKopf").html(r.variante.kopfform),$(".view-halterOhneBohrung-HalterAuswahlPreis").html(API.priceView(r.variante.preis));var a=Konfigurator.config.halterImgPfad+r.variante.bild,o=Konfigurator.config.halterImgPfad+Konfigurator.helper.getMiniImgData("path")+Konfigurator.helper.getMiniImgData("name",r.variante.bild);$(".view-halterOhneBohrung-Img").attr("href",a).show(),$(".view-halterOhneBohrung-Img-preview").attr("src",o),$(".view-halterOhneBohrung-selection").show(),$("#editHalterOhneBohrungBtn").show(),$("#addHalterOhneBohrungBtn").hide()}else{$("#halter-mitBohrung-AbstandEdit").show(),$("#view-halterMitBohrung-auswahlHId").val(i.hid),$("#view-halterMitBohrung-variantenId").val(i.vid),$("#view-halterMitBohrung-configIndex").val(i.index),$("#view-halterMitBohrung-x").val(i.x),$("#view-halterMitBohrung-y").val(i.y),$(".view-halterMitBohrung-HalterAuswahlPreview").html(r.variante.name),$(".view-halterMitBohrung-HalterAuswahlMaterial").html(r.variante.material),$(".view-halterMitBohrung-HalterAuswahlArtNr").html(r.variante.artnr),$(".view-halterMitBohrung-HalterAuswahlWand").html(API.dotToComma(r.variante.wandabstand)),$(".view-halterMitBohrung-HalterAuswahlSize").html(0==r.variante.halterkantenlaenge?"&Oslash;"+API.dotToComma(r.variante.durchmesser):API.dotToComma(r.variante.halterkantenlaenge)+" x "+API.dotToComma(r.variante.halterkantenlaenge)),$(".view-halterMitBohrung-HalterAuswahlKopf").html(r.variante.kopfform),$(".view-halterMitBohrung-HalterAuswahlPreis").html(API.priceView(r.variante.preis));var a=Konfigurator.config.halterImgPfad+r.variante.bild,o=Konfigurator.config.halterImgPfad+Konfigurator.helper.getMiniImgData("path")+Konfigurator.helper.getMiniImgData("name",r.variante.bild);$(".view-halterMitBohrung-Img").attr("href",a).show(),$(".view-halterMitBohrung-Img-preview").attr("src",o),$(".view-halterMitBohrung-selection").show(),$("#editHalterMitBohrungBtn").show(),$("#addHalterMitBohrungBtn").hide(),Halter.corner.unSetCorner(i.corner),setTimeout(function(){API.markEckenCheckboxElementByLabel($("#halterMitBohrungCheckBox"),i.corner)},100),View.Halter.mitBohrung.createEckSelectionView()}},addHalterMitBohrungFunction:function(e){e.preventDefault();var t=$("#view-halterMitBohrung-auswahlHId").val(),n=$("#view-halterMitBohrung-variantenId").val(),i=$("#halterMitBohrungCheckBox"),r=i.find("label.active input"),a=$("#view-halterMitBohrung-x"),o=$("#view-halterMitBohrung-y"),l=i.parent("div").parent("div").parent("div").find("div.error"),u=!0;if(u=u&&Validate.materialSet(l),u||Dispatcher.addErrorField(Dispatcher.Type.Halter,l),u=u&&Validate.isCheckboxSelected(i,l),u=u&&Validate.checkRegexp(a,l),u=u&&Validate.checkRegexp(o,l)){var h=Konfigurator.helper.getHalter(t,n),c=null;$.each(r,function(e,i){var r=$(i).val();if("ALLE"!=r){var l=$(i).parent("label").attr("disabled");if(!API.isset(l)){if(7==t){for(var u=h.variante.plattenbohrungUnterseite,s=0,g=0,d=Konfigurator.data.senkungen,e=0;e<d.length;e++)parseFloat(d[e].bohrung)==parseFloat(u)&&(g=parseFloat(d[e].gewinde),s=parseFloat(d[e].senkung));c=Bearbeitungen.Senkungen.addConfiguration(2,r,g,u,s,a.val(),o.val(),null,!0)}else{var u=h.variante.plattenbohrungUnterseite;c=Bearbeitungen.Bohrungen.addConfiguration(1,r,u,a.val(),o.val(),null,!0)}Halter.addConfiguration(t,n,r,a.val(),o.val(),null,null,c)}}}),View.Halter.mitBohrung.createEckSelectionView(),View.Halter.mitBohrung.createSelectionView(),View.Bearbeitungen.Senkungen.createEckSelectionView(),View.Bearbeitungen.Senkungen.createSelectionView(),View.Bearbeitungen.Bohrungen.createEckSelectionView(),View.Bearbeitungen.Bohrungen.createSelectionView(),View.Configuration.createView.insertHalterView(),View.Configuration.createView.insertSenkungView(),View.Configuration.createView.insertBohrungView(),Price.createPriceView(),Konfigurator.helper.drawCADImg(),$(".view-halterMitBohrung-HalterAuswahlPreview").html("&nbsp;"),$(".view-halterMitBohrung-HalterAuswahlMaterial").html("&nbsp;"),$(".view-halterMitBohrung-HalterAuswahlArtNr").html("&nbsp;"),$(".view-halterMitBohrung-HalterAuswahlWand").html("&nbsp;"),$(".view-halterMitBohrung-HalterAuswahlSize").html("&nbsp;"),$(".view-halterMitBohrung-HalterAuswahlKopf").html("&nbsp;"),$(".view-halterMitBohrung-HalterAuswahlPreis").html("&nbsp;"),$(".view-halterMitBohrung-selection").hide()}},addHalterOhneBohrungFunction:function(e){e.preventDefault();var t=$("#view-halterOhneBohrung-auswahlHId").val(),n=$("#view-halterOhneBohrung-variantenId").val(),i=$("#view-halterOhneBohrung-qty"),r=i.parent("div").parent("div").parent("div").parent("div").parent("div").find("div.error"),a=!0;a=a&&Validate.materialSet(r),
a||Dispatcher.addErrorField(Dispatcher.Type.Halter,r),a=a&&Validate.checkRegexp(i,r),a&&(Halter.addConfiguration(t,n,null,null,null,null,i.val()),View.Configuration.createView.insertHalterView(),$("#view-halterOhneBohrung-qty").val(""),Price.createPriceView(),View.Halter.ohneBohrung.createSelectionView(),Konfigurator.helper.drawCADImg(),$(".view-halterOhneBohrung-HalterAuswahlPreview").html("&nbsp;"),$(".view-halterOhneBohrung-HalterAuswahlMaterial").html("&nbsp;"),$(".view-halterOhneBohrung-HalterAuswahlArtNr").html("&nbsp;"),$(".view-halterOhneBohrung-HalterAuswahlWand").html("&nbsp;"),$(".view-halterOhneBohrung-HalterAuswahlSize").html("&nbsp;"),$(".view-halterOhneBohrung-HalterAuswahlKopf").html("&nbsp;"),$(".view-halterOhneBohrung-HalterAuswahlPreis").html("&nbsp;"),$(".view-halterOhneBohrung-selection").hide())}}},Material:{changeSizeView:function(e,t,n){for(var i=Konfigurator.data.material,r="",a=0;a<i.length;a++){if(i[a].uid==t)for(var o=0;o<i[a].varianten.length;o++)if(i[a].varianten[o].uid==n)for(var l=0;l<i[a].varianten[o].formen.length;l++)r+='<p><input  class="addMaterialBtn" id="size_'+i[a].uid+"_"+i[a].varianten[o].uid+"_"+i[a].varianten[o].formen[l].uid+'" type="radio" name="dicke" value="'+i[a].varianten[o].formen[l].dicke+'"><label for="size_'+i[a].uid+"_"+i[a].varianten[o].uid+"_"+i[a].varianten[o].formen[l].uid+'">'+i[a].varianten[o].formen[l].dicke+" mm</label></p>";$("#sizeAuswahl_"+e).html(r)}},changeImagePreview:function(){}},Bearbeitungen:{Kanten:{createKantenAuswahl:function(){var e=Konfigurator.data.kanten,t=Konfigurator.config.bearbeitungImgPfad,n=!1,i="",r="",a=Bearbeitungen.Kanten.getCurrentConfiguration(),o="";o+="<select>";for(var l=0;l<e.length;l++)this.bearbeitungErlaubt(e[l].uid)&&(o+="<option",API.isset(a.uid)&&parseInt(a.uid)==parseInt(e[l].uid)&&(o+=' selected="selected" ',n||(n=!0,i=t+e[l].bild,r=t+Konfigurator.helper.getMiniImgData("path")+Konfigurator.helper.getMiniImgData("name",e[l].bild))),o+=' value="'+e[l].uid+'">'+e[l].name+"</option>");if(o+="</select>",$("#view-kanten-auswahl").html(o),$("#view-kanten-img-preview").attr("src",r),$("#view-kanten-img").attr("href",i),API.isset(a.facette)&&""!=a.facette){$("#view-kanten-facette").val(a.facette),$("#view-kanten-angle").val(a.angle),$("#view-facetten-eigenschaften").show(),$("#view-kanten-eigenschaften").hide();for(var l=0;l<e.length;l++)parseInt(e[l].uid)==parseInt(a.uid)&&(i=t+e[l].bild,r=t+Konfigurator.helper.getMiniImgData("path")+Konfigurator.helper.getMiniImgData("name",e[l].bild));$("#view-facceten-img-preview").attr("src",r),$("#view-facceten-img").attr("href",i)}else $("#view-facetten-eigenschaften").hide()},bearbeitungErlaubt:function(e){var t=Konfigurator.dependencies.kanten,n=Material.getCurrentConfiguration();if(!API.isset(n.uid))return!0;for(var i=0;i<t.length;i++)if(parseInt(t[i].uid)==parseInt(e))return $.inArray(parseInt(n.uid),t[i].material)>-1?!0:!1}},Ecken:{createEckBearbeitungAuswahl:function(){var e=Konfigurator.data.ecken,t=Bearbeitungen.Kanten.getCurrentConfiguration(),n="",i=!1;n+='<div id="eckenAuswahlBox" class="btn-group">';for(var r=0;r<e.length;r++)n+='<button class="btn btn-glacryl" type="button" value="'+e[r].uid+'" name="eckenAuswahlBox" id="eckenAuswahlBox'+r+'">'+e[r].name+"</button>";n+='<input type="hidden" id="selectedEckBearbeitung" value="" />',n+="</div>",2==t.uid||4==t.uid||(n+='<span class="ui-icon ui-icon-info ecken-info-btn"></span>',i=!0),$("#view-ekcen-auswahl").html(n),i&&Tooltips.initialize(),this.switchSelection()},switchSelection:function(){var e=Bearbeitungen.Kanten.getCurrentConfiguration(),t=Konfigurator.data.ecken;if(null!=e.uid)for(var n=0;n<t.length;n++)Konfigurator.helper.isEckeForKanteEnabled(t[n].uid,e.uid)?API.enableButton($("#eckenAuswahlBox").find("button[value="+t[n].uid+"]")):API.disableButton($("#eckenAuswahlBox").find("button[value="+t[n].uid+"]"))},createEckSelectionView:function(){var e=Bearbeitungen.Ecken.corner,t="";t+='<div id="eckenCheckBox"  class="btn-group" data-toggle="buttons">',t+='<label class="btn btn-glacryl">',t+='<input type="checkbox" value="ALLE" />ALLE',t+="</label>";for(var n=0;n<e.corner.length;n++)t+='<label class="btn btn-glacryl">',t+='<input type="checkbox" value="'+e.corner[n]+'" />'+e.corner[n],t+="</label>";t+="</div>",$("#view-ecken-eckAuswahl").html(t);var i=$("#eckenCheckBox label");$.each(i,function(e,t){var n=Bearbeitungen.Ecken.corner,i=$(t).find("input").val();n.isCornerSet(i)&&API.disableCheckBox($(t))})},createSelectionView:function(){for(var e=Bearbeitungen.Ecken.getCurrentConfiguration(),t="",n=0;n<e.length;n++)t+="<tr>",t+="<td>"+e[n].corner+"</td>",t+="<td>"+(null!=e[n].x?e[n].x:" - ")+"</td>",t+="<td>"+(null!=e[n].y?e[n].y:" - ")+"</td>",t+="<td>"+(null!=e[n].radius?e[n].radius:" - ")+"</td>",t+='<td><span class="sprite-Stift editEckenBtn"></span><span class="sprite-Loeschen deleteEckenBtn"></span><span class="sprite-Bestaetigen acceptEckenBtn"></span></td>',t+="</tr>";$("#view-ecken-selection table").find("tbody").html(t),$(".acceptEckenBtn").hide()}},Bohrungen:{iniBohrungView:function(){for(var e=Konfigurator.data.bohrungen,t=Konfigurator.config.bearbeitungImgPfad,n="",i="",r=0;r<e.length;r++)1==e[r].uid&&(n=t+e[r].bild,i=t+Konfigurator.helper.getMiniImgData("path")+Konfigurator.helper.getMiniImgData("name",e[r].bild));$("#view-bohrung-img").attr("href",n),$("#view-bohrung-img-preview").attr("src",i)},createEckSelectionView:function(){var e=Bearbeitungen.Bohrungen.corner,t="";t+='<div id="bohrungenCheckBox" class="btn-group" data-toggle="buttons">',t+='<label class="btn btn-glacryl">',t+='<input type="checkbox" value="ALLE" />ALLE',t+="</label>";for(var n=0;n<e.corner.length;n++)t+='<label class="btn btn-glacryl">',t+='<input type="checkbox" value="'+e.corner[n]+'">'+e.corner[n],t+="</label>";t+='<label class="btn btn-glacryl">',t+='<input type="checkbox" value="FREI" />FREI',t+="</label>",t+="</div>",$("#view-bohrungen-eckAuswahl").html(t);var i=$("#bohrungenCheckBox label");$.each(i,function(e,t){var n=Bearbeitungen.Bohrungen.corner,i=$(t).find("input").val();n.isCornerSet(i)&&API.disableCheckBox($(t))})},createSelectionView:function(){for(var e=Bearbeitungen.Bohrungen.getCurrentConfiguration(),t="",n=0;n<e.length;n++)t+="<tr>",t+='<td><input type="hidden" value="'+e[n].index+'" /><span>'+e[n].corner+"</span></td>",t+="<td>"+(null!=e[n].x?e[n].x:" - ")+"</td>",t+="<td>"+(null!=e[n].y?e[n].y:" - ")+"</td>",t+="<td>"+(null!=e[n].dB?e[n].dB:" - ")+"</td>",t+='<td><span class="sprite-Stift editBohrungenBtn"></span><span class="sprite-Loeschen deleteBohrungenBtn"></span><span class="sprite-Bestaetigen acceptBohrungenBtn"></span></td>',t+="</tr>";$("#view-bohrungen-selection table").find("tbody").html(t),$(".acceptBohrungenBtn").hide()}},Senkungen:{iniSenkungView:function(){for(var e=Konfigurator.data.bohrungen,t=Konfigurator.config.bearbeitungImgPfad,n="",i="",r=0;r<e.length;r++)2==e[r].uid&&(n=t+e[r].bild,i=t+Konfigurator.helper.getMiniImgData("path")+Konfigurator.helper.getMiniImgData("name",e[r].bild));$("#view-senkung-img-preview").attr("src",i),$("#view-senkung-img").attr("href",n)},createSchraubenMView:function(){var e=Konfigurator.data.senkungen,t="";t+='<label for="view-senkungen-m" style="font-size: 11pt ! important; margin: 5px 0px 5px;">F&uuml;r Gewindeschrauben</label>',t+='<label for="view-senkungen-m" style="display:inline-block !important;margin-right:12px;">M</label>',t+='<select style="display:inline-block; width:30%;" id="view-senkungen-m">';for(var n=0;n<e.length;n++)t+='<option valu="'+Number(e[n].gewinde)+'">'+Number(e[n].gewinde)+"</option>";t+="</select>",$("#view-senkungen-schrauben").html(t)},createEckSelectionView:function(){var e=Bearbeitungen.Senkungen.corner,t="";t+='<div id="senkungenCheckBox" class="btn-group" data-toggle="buttons">',t+='<label class="btn btn-glacryl">',t+='<input type="checkbox" value="ALLE" />ALLE',t+="</label>";for(var n=0;n<e.corner.length;n++)t+='<label class="btn btn-glacryl">',t+='<input type="checkbox" value="'+e.corner[n]+'">'+e.corner[n],t+="</label>";t+='<label class="btn btn-glacryl">',t+='<input type="checkbox" value="FREI">FREI',t+="</label>",t+="</div>",$("#view-senkungen-eckAuswahl").html(t);var i=$("#senkungenCheckBox label");$.each(i,function(e,t){var n=Bearbeitungen.Senkungen.corner,i=$(t).find("input").val();n.isCornerSet(i)&&API.disableCheckBox($(t))})},createSelectionView:function(){for(var e=Bearbeitungen.Senkungen.getCurrentConfiguration(),t="",n=0;n<e.length;n++)t+="<tr>",t+='<td><input type="hidden" value="'+e[n].index+'" /><span>'+e[n].corner+"</span></td>",t+="<td>"+(null!=e[n].x?e[n].x:" - ")+"</td>",t+="<td>"+(null!=e[n].y?e[n].y:" - ")+"</td>",t+="<td>"+(null!=e[n].m?e[n].m:" - ")+"</td>",t+='<td><span class="sprite-Stift editSenkungenBtn"></span><span class="sprite-Loeschen deleteSenkungenBtn"></span><span class="sprite-Bestaetigen acceptSenkungenBtn"></span></td>',t+="</tr>";$("#view-senkungen-selection table").find("tbody").html(t),$(".acceptSenkungenBtn").hide()}}},Halter:{mitBohrung:{istHalterErlaubt:function(e){var t=Material.getCurrentConfiguration(),n=Konfigurator.data.halter;if(null!=t.uid){for(var i=0;i<n.length;i++)if(n[i].uid==e)for(var r=0;r<n[i].varianten.length;r++)return"kante"!=n[i].varianten[r].position&&(parseFloat(t.size)>=parseFloat(n[i].varianten[r].materialVon)||-1==parseFloat(n[i].varianten[r].materialVon))&&(parseFloat(t.size)<=parseFloat(n[i].varianten[r].materialBis)||-1==parseFloat(n[i].varianten[r].materialBis))?!0:!1}else for(var i=0;i<n.length;i++)if(n[i].uid==e)for(var r=0;r<n[i].varianten.length;r++)return"kante"!=n[i].varianten[r].position?!0:!1},createEckSelectionView:function(){var e=Halter.corner,t="";t+='<div id="halterMitBohrungCheckBox" class="btn-group" data-toggle="buttons">',t+='<label class="btn btn-glacryl">',t+='<input type="checkbox" value="ALLE" />ALLE',t+="</label>";for(var n=0;n<e.corner.length;n++)t+='<label class="btn btn-glacryl">',t+='<input type="checkbox" value="'+e.corner[n]+'" />'+e.corner[n],t+="</label>";t+='<label class="btn btn-glacryl">',t+='<input type="checkbox" value="FREI" />FREI',t+="</label>",t+="</div>",$("#view-halterMitBohrung-eckAuswahl").html(t);var i=$("#halterMitBohrungCheckBox label");$.each(i,function(e,t){var n=Halter.corner,i=$(t).find("input").val();n.isCornerSet(i)&&API.disableCheckBox($(t))})},createSelectionView:function(){for(var e=Halter.getCurrentConfiguration(),t=Konfigurator.data.halter,n="",i=0;i<e.length;i++)if(API.isset(e[i].corner)){n+="<tr>",n+='<td><input type="hidden" value="'+e[i].index+'" /><span>'+e[i].corner+"</span></td>",n+="<td>"+e[i].x+"</td>",n+="<td>"+e[i].y+"</td>";for(var r=0;r<t.length;r++)if(t[r].uid==e[i].hid)for(var a=0;a<t[r].varianten.length;a++)t[r].varianten[a].uid==e[i].vid&&(n+='<td><input type="hidden" class="hId" value="'+e[i].hid+'" /><input type="hidden" class="vId" value="'+e[i].vid+'" />Art.Nr.: '+t[r].varianten[a].artnr+"</td>");n+="<td>",n+='<span class="sprite-Stift editHalterBtn"></span>',n+='<span class="sprite-Loeschen deleteHalterBtn"></span>',n+='<span class="info-halterMit-icon">i</span></td>',n+="</tr>"}$("#view-halterMitBohrung-selection table").find("tbody").html(n)}},ohneBohrung:{istHalterErlaubt:function(e){var t=Material.getCurrentConfiguration(),n=Konfigurator.data.halter;if(null!=t.uid){for(var i=0;i<n.length;i++)if(n[i].uid==e)for(var r=0;r<n[i].varianten.length;r++)return"kante"==n[i].varianten[r].position&&(parseFloat(t.size)>=parseFloat(n[i].varianten[r].materialVon)||-1==parseFloat(n[i].varianten[r].materialVon))&&(parseFloat(t.size)<=parseFloat(n[i].varianten[r].materialBis)||-1==parseFloat(n[i].varianten[r].materialBis))?!0:!1}else for(var i=0;i<n.length;i++)if(n[i].uid==e)for(var r=0;r<n[i].varianten.length;r++)return"kante"==n[i].varianten[r].position?!0:!1},createSelectionView:function(){for(var e=Halter.getCurrentConfiguration(),t=Konfigurator.data.halter,n="",i=0;i<e.length;i++)if(!API.isset(e[i].corner)){n+="<tr>",n+='<td><input type="hidden" value="'+e[i].index+'" /><span>'+e[i].qty+"</span></td>";for(var r=0;r<t.length;r++)if(t[r].uid==e[i].hid)for(var a=0;a<t[r].varianten.length;a++)t[r].varianten[a].uid==e[i].vid&&(n+='<td><input type="hidden" class="hId" value="'+e[i].hid+'" /><input type="hidden" class="vId" value="'+e[i].vid+'" />Art.Nr.: '+t[r].varianten[a].artnr+"</td>");n+="<td>",n+='<span class="sprite-Stift editHalterBtn"></span>',n+='<span class="sprite-Loeschen deleteHalterBtn"></span>',n+='<span class="info-halterOhne-icon">i</span></td>',n+="</tr>"}$("#view-halterOhneBohrung-selection table").find("tbody").html(n)}}},Configuration:{createView:{initialize:function(){this.insertMaterialView(),this.insertGrundEinstellungenView(),this.insertKantenView(),this.insertEckenView(),this.insertBohrungView(),this.insertSenkungView(),this.insertHalterView(),this.iniDialog()},iniDialog:function(){$("#konfigurator-success-Dialog").dialog({autoOpen:!1,resizable:!1,height:"auto",width:"auto",modal:!0,buttons:{"Weiter einkaufen":function(){Konfigurator.clearEditState(),$(this).dialog("close")},"Zum Warenkorb":function(){$(this).dialog("close");var e=$("base").attr("href"),t=e+"shop/?tx_glshop_glacrylshop%5Baction%5D=index&tx_glshop_glacrylshop%5Bcontroller%5D=Cart";window.location=t}}}),$("#konfigurator-error-Dialog").dialog({autoOpen:!1,resizable:!1,height:"auto",modal:!0,buttons:{OK:function(){$(this).dialog("close")}}}),$("#konfigurator-qty-Dialog").dialog({autoOpen:!1,resizable:!1,height:"auto",modal:!0,buttons:{OK:function(){$(this).dialog("close"),$("konfigurator-qty-warning").html("")}},close:function(){$("#konfigurator-success-Dialog").dialog("open")}}),$("#konfigurator-changeKante-sizeInfo-Dialog").dialog({autoOpen:!1,resizable:!1,height:"auto",modal:!0,buttons:{OK:function(){$(this).dialog("close")}}}),$("#konfigurator-changeKanten-Dialog").dialog({autoOpen:!1,resizable:!1,height:"auto",modal:!0,buttons:{Ja:function(){for(var e=Dispatcher.transition.ecken,t=0;t<e.length;t++)Bearbeitungen.Ecken.removeConfiguration(e[t].corner);View.Configuration.createView.insertEckenView(),Price.createPriceView(),Dispatcher.clearTransition(),View.actions.Bearbeitungen.changeAndSaveKantenAuswahlFunction(),View.Bearbeitungen.Ecken.createEckBearbeitungAuswahl(),View.Bearbeitungen.Ecken.createEckSelectionView(),View.Bearbeitungen.Ecken.createSelectionView(),$(".view-eckbearbeitung-rund").hide(),$("#view-ecken-img").hide(),$(this).dialog("close")},Nein:function(){Dispatcher.clearTransition(),$(this).dialog("close")}}})},insertMaterialView:function(){var e=Konfigurator.data.material,t=Material.getCurrentConfiguration(),n="Bitte Material w&auml;hlen";if(null!=t.uid)for(var i=0;i<e.length;i++)if(e[i].uid==t.uid)for(var r=0;r<e[i].varianten.length;r++)e[i].varianten[r].uid==t.vid&&(n=e[i].name+" "+t.size+" mm "+e[i].varianten[r].name);$("#view-configuration-material").html(n),this.insertGrundEinstellungenView()},insertGrundEinstellungenView:function(){var e=Grundeinstellung.getCurrentConfiguration(),t="keine";null!=e.height&&null!=e.width&&(t=e.width+" x "+e.height+" mm"),$("#view-configuration-size span").html(t)},insertKantenView:function(){var e=Bearbeitungen.Kanten.getCurrentConfiguration(),t="keine";if(null!=e.uid){var n=Konfigurator.helper.getKanten(e.uid);t=n.name}$("#view-configuration-kanten span").html(t)},insertEckenView:function(){var e=Bearbeitungen.Ecken.getCurrentConfiguration(),t=Konfigurator.data.ecken,n="keine",i={schraeg:0,rund:0};if(e.length>0){for(var r=0;r<e.length;r++)for(var a=0;a<t.length;a++)e[r].uid==t[a].uid&&(1==parseInt(e[r].uid)?"ALLE"==e[r].corner?i.schraeg+=4:i.schraeg++:"ALLE"==e[r].corner?i.rund+=4:i.rund++);i.schraeg>0&&i.rund>0?n=i.schraeg+"x mit Schr&auml;gecke und "+i.rund+"x mit Rundecke":i.schraeg>0?n=i.schraeg+"x Schr&auml;gecke ":i.rund>0&&(n=i.rund+"x Rundecke ")}$("#view-configuration-ecken span").html(n)},insertBohrungView:function(){var e=Bearbeitungen.Bohrungen.getCurrentConfiguration(),t="keine",n=0;if(e.length>0){for(var i=0;i<e.length;i++)"ALLE"==e[i].corner?n+=4:n++;t=n+"x Bohrung(en)"}$("#view-configuration-bohrungen span").html(t)},insertSenkungView:function(){var e=Bearbeitungen.Senkungen.getCurrentConfiguration(),t="keine",n=0;if(e.length>0){for(var i=0;i<e.length;i++)"ALLE"==e[i].corner?n+=4:n++;t=n+"x Senkung(en)"}$("#view-configuration-senkungen span").html(t)},insertHalterView:function(){var e=Halter.getCurrentConfiguration(),t="keine",n=0,i=0;if(e.length>0){for(var r=0;r<e.length;r++){Konfigurator.helper.getHalter(e[r].hid,e[r].vid);null==e[r].corner?i+=parseInt(e[r].qty):"ALLE"==e[r].corner?n+=4:n++}n>0&&i>0?t=n+"x mit und "+i+"x ohne Bohrungen":n>0?t=n+"x mit Bohrungen ":i>0&&(t=i+"x ohne Bohrungen ")}$("#view-configuration-halter span").html(t)}}}};$(function(){Konfigurator.initialize(),Konfigurator.mobileSchild=new Schild,Konfigurator.resetKonfiguratorView(),View.actions.initializeFirst(),HalterFilter.iniFirst(),Tooltips.initialize(null),$("#view-configuration-width").focus()})}(jQuery);