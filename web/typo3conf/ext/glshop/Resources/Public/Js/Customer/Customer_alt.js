!function($){var API={usedIds:new Array,isMobile:window.matchMedia("only screen and (max-width: 40em)"),createRandomNumber:function(){var t=Math.floor(10002*Math.random()+1);return-1==$.inArray(t,this.usedIds)?(this.usedIds.push(t),t):this.createRandomNumber()},ajax:function(async,data,type,dataType,sMsg,eMsg){var res=$.ajax({url:"index.php",async:async,global:!1,data:data,type:type,dataType:dataType,success:function(){null!=sMsg&&alert(sMsg)},error:function(){null!=eMsg&&alert(eMsg)}}).responseText;return"json"==dataType&&""!=res&&null!=res&&res.length>0&&(res=eval("("+res+")")),res},dotToComma:function(t){return t+="",t=t.replace(".",",")},commaToDot:function(t){return t+="",t=t.replace(".",""),t=t.replace(",",".")},round:function(t,e){if(1>e||e>14)return!1;var a=Math.pow(10,e),i=(Math.round(t*a)/a).toString();return-1==i.indexOf(".")&&(i+="."),i+=a.toString().substring(1),i.substring(0,i.indexOf(".")+e+1)},priceView:function(t){function e(t,e,n){e||(e=0);var r="",s=0>t?"-":"",l=Math.pow(10,e),d=Math.abs(t);d=""+parseInt(d*l+.5)/l;var o=d.indexOf(".");for(n&&e&&(d+=(-1==o?".":"")+l.toString().substring(1)),o=d.indexOf("."),-1==o?o=d.length:r=a+d.substr(o+1,e);o>0;)r=o-3>0?i+d.substring(o-3,o)+r:d.substring(0,o)+r,o-=3;return s+r}var a=",",i=".";return e(t,2,!0)},isset:function(t){return"undefined"!=typeof t&&null!=t?!0:!1}},Validate={config:{regexp:{ganzeZahl:{exp:/^([0-9_])+$/i,text:"Dieses Feld darf nur ganze Zahlen enthalten!"}},material:{max:2030,min:1520},facette:{max:20,min:0},maxQty:100},updateText:function(t,e){e?$(t).show().html(e):$(t).hide().html("")},addErrorStyle:function(t){t.attr("style","border: 1px solid #A51107 !important; color: #A51107 !important; overflow:hidden; padding:0px !important;padding-left:4px !important;")},removeErrorStyle:function(t){t.removeAttr("style")},emptyField:function(t,e){var a=[];for(var i in t)""==t[i].val()&&a.push(i);if(a.length>1){for(var n="Die Felder ",r=0;r<a.length;r++)n+=0==r?'"'+a[r]+'"':', "'+a[r]+'"';return n+=" d&uuml;rfen nicht leer sein!",this.updateText(e,n),!1}return 1==a.length?(this.updateText(e,'Das Feld "'+a[0]+'" darf nicht leer sein!'),!1):(this.updateText(e,""),!0)},checkRegexp:function(t,e){var a=this.config.regexp.ganzeZahl.exp,i=this.config.regexp.ganzeZahl.text;return t.is(":visible")?a.test(t.val())?(this.removeErrorStyle(t),this.updateText(e,""),e.parent("div").attr("style","margin-top:-8px;").parent("div").attr("style","height: 258px;").prev("div").attr("style","width: 100%; background-color: rgba(255, 255, 255, 0.3); position: absolute; height: 245px;"),!0):(this.addErrorStyle(t),this.updateText(e,i),e.parent("div").attr("style","margin-top:-8px;").parent("div").attr("style","height: 258px;").prev("div").attr("style","width: 100%; background-color: rgba(255, 255, 255, 0.3); position: absolute; height: 245px;"),!1):(this.removeErrorStyle(0),this.updateText(e,""),e.parent("div").attr("style","margin-top:-8px;").parent("div").attr("style","height: 212px;").prev("div").attr("style","width: 100%; background-color: rgba(255, 255, 255, 0.3); position: absolute; height: 200px;"),!0)},isRadioSelected:function(t,e){return t.is(":visible")?""==t.find(":radio:checked").val()||"undefined"==typeof t.find(":radio:checked").val()?(this.addErrorStyle(t),this.updateText(e,"Bitte w&auml;hlen Sie einen Wert im markierten Bereich aus!"),!1):(this.removeErrorStyle(t),this.updateText(e),!0):!0}},Konto={View:{initializeFirst:function(){$(".bestellungen-table").dataTable({language:{url:"//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/German.json"},order:[[2,"desc"]],bProcessing:!0,bDeferRender:!0,bAutoWidth:!1,bJQueryUI:!0,columnDefs:[{type:"natural",targets:0},{type:"de_datetime",targets:1}]}),$("#customer-notice-table").dataTable({language:{url:"//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/German.json"},order:[[2,"desc"]],bProcessing:!0,bDeferRender:!0,bAutoWidth:!1,bJQueryUI:!0,columnDefs:[{type:"natural",targets:0},{type:"de_datetime",targets:2},{type:"de_datetime",targets:3}]}),$(".adressen-table").dataTable({language:{url:"//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/German.json"},order:[[2,"desc"]],bProcessing:!0,bDeferRender:!0,bAutoWidth:!1,bJQueryUI:!0,columnDefs:[{type:"natural",targets:0},{type:"natural",targets:1},{type:"natural",targets:2}]}),$("#add-Notice-To-Order-Dialog").dialog({autoOpen:!1,resizable:!1,height:"auto",modal:!0,buttons:{Ja:function(){var t=new Object;t.eID="ajaxDispatcher",t.request={pluginName:"Glacrylshop",controller:"Aj",action:"clearFromNoticeList",arguments:{ids:$("#notice-position-ids-added").val()}};API.ajax(!1,t,"GET","json");$(this).dialog("close");var e=$("base").attr("href"),a=e+"shop/?tx_glshop_glacrylshop%5Baction%5D=noticelist&tx_glshop_glacrylshop%5Bcontroller%5D=Customer";window.location=a},Nein:function(){$("#notice-position-ids-added").val(""),$(this).dialog("close")}}}),$("#notice-detail-Dialog").dialog({autoOpen:!1,resizable:!1,height:"auto",width:"80%",modal:!0,buttons:{Ok:function(){$(this).dialog("close")}}}),this.Actions.initialize()},Actions:{initialize:function(){$("body").on("click",".edit-firmenDaten",Konto.View.Actions.editFirmaBTNAction),$("body").on("click",".accept-firmenDaten",Konto.View.Actions.acceptFirmaBTNAction),$("body").on("click",".edit-firmenAdresse",Konto.View.Actions.editAdressBTNAction),$("body").on("click",".accept-firmenAdresse",Konto.View.Actions.acceptAdressBTNAction),$("body").on("click",".edit-ansprechpartner",Konto.View.Actions.editPartnerBTNAction),$("body").on("click",".accept-ansprechpartner",Konto.View.Actions.acceptPartnerBTNAction),$("body").on("click",".edit-kontakt",Konto.View.Actions.editKontaktBTNAction),$("body").on("click",".accept-kontakt",Konto.View.Actions.acceptKontaktBTNAction),$("body").on("click",".orderNoticeBtn",Konto.View.Actions.orderFromNoticeListFunction),$("body").on("click",".noticeItem-DetailBtn",Konto.View.Actions.viewNoticeDetailFunction),$("body").on("click","#back-to-Top-Lnk",Konto.View.Actions.backToTopFunction)},viewNoticeDetailFunction:function(t){t.preventDefault();var e=new Object;e.eID="ajaxDispatcher",e.request={pluginName:"Glacrylshop",controller:"Aj",action:"getNoticeDetail",arguments:{ids:$(this).prev(".notice-positions").val()}};var a=API.ajax(!1,e,"GET","json");Konto.View.Templates.detail(a),$("#notice-detail-Dialog").dialog("open")},orderFromNoticeListFunction:function(t){var e=new Object;e.eID="ajaxDispatcher",e.request={pluginName:"Glacrylshop",controller:"Aj",action:"orderFromNoticeList",arguments:{ids:$(this).prev(".notice-positions").val()}};API.ajax(!1,e,"GET","json");$("#notice-position-ids-added").val($(this).prev(".notice-positions").val()),$("#add-Notice-To-Order-Dialog").dialog("open")},backToTopFunction:function(t){t.preventDefault();var e=$(this).attr("href");$("html, body").animate({scrollTop:$(e).offset().top},"slow")},acceptFirmaBTNAction:function(t){t.preventDefault();var e=$("span.data-kdFirma input").val(),a=$("span.data-kdUstId input").val(),i=new Object;i.eID="ajaxDispatcher",i.request={pluginName:"Glacrylshop",controller:"Aj",action:"editUser",arguments:{firma:e,ustId:a}};var n=API.ajax(!1,i,"GET","json");"false"==n.error&&($(this).removeClass("sprite-Bestaetigen accept-firmenDaten").addClass("sprite-Stift edit-firmenDaten"),$("span.data-kdFirma").html(n.user.firma),$("span.data-kdUstId").html(n.user.ustId))},editFirmaBTNAction:function(t){t.preventDefault(),$(this).removeClass("sprite-Stift edit-firmenDaten").addClass("sprite-Bestaetigen accept-firmenDaten");var e=$(this).parent("legend").parent("fieldset").find("div span");e.each(function(t,e){var a=$(e).text();0!=t&&$(e).html('<input type="text" value="'+a+'" />')})},acceptAdressBTNAction:function(t){t.preventDefault();var e=$("span.data-kdStr input").val(),a=$("span.data-kdPlz input").val(),i=$("span.data-kdOrt input").val(),n=new Object;n.eID="ajaxDispatcher",n.request={pluginName:"Glacrylshop",controller:"Aj",action:"editUser",arguments:{str:e,plz:a,ort:i}};var r=API.ajax(!1,n,"GET","json");"false"==r.error&&($(this).removeClass("sprite-Bestaetigen accept-firmenAdresse").addClass("sprite-Stift edit-firmenAdresse"),$("span.data-kdStr").html(r.user.str),$("span.data-kdPlz").html(r.user.plz),$("span.data-kdOrt").html(r.user.ort))},editAdressBTNAction:function(t){t.preventDefault(),$(this).removeClass("sprite-Stift edit-firmenAdresse").addClass("sprite-Bestaetigen accept-firmenAdresse");var e=$(this).parent("legend").parent("fieldset").find("div span");e.each(function(t,e){var a=$(e).text();$(e).html('<input type="text" value="'+a+'" />')})},acceptPartnerBTNAction:function(t){t.preventDefault();var e=$("span.data-kdSex select").val(),a=$("span.data-kdName input").val(),i=$("span.data-kdVorname input").val(),n=new Object;n.eID="ajaxDispatcher",n.request={pluginName:"Glacrylshop",controller:"Aj",action:"editUser",arguments:{sex:e,name:a,vorname:i}};var r=API.ajax(!1,n,"GET","json");"false"==r.error&&($(this).removeClass("sprite-Bestaetigen accept-ansprechpartner").addClass("sprite-Stift edit-ansprechpartner"),$("span.data-kdSex").html(0==r.user.sex?"Herr":"Frau"),$("span.data-kdName").html(r.user.name),$("span.data-kdVorname").html(r.user.vorname))},editPartnerBTNAction:function(t){t.preventDefault(),$(this).removeClass("sprite-Stift edit-ansprechpartner").addClass("sprite-Bestaetigen accept-ansprechpartner");var e=$(this).parent("legend").parent("fieldset").find("div span");e.each(function(t,e){var a=$(e).text(),i="";0==t?(i="<select>",i+='<option value="null">&nbsp;</option>',i+='<option value="1"'+("Frau"==a?" selected ":0)+">Frau</option>",i+='<option value="0"'+("Herr"==a?" selected ":0)+">Herr</option>",i+="</select>"):i+='<input type="text" value="'+a+'" />',$(e).html(i)})},acceptKontaktBTNAction:function(t){t.preventDefault();var e=$("span.data-kdMail input").val(),a=$("span.data-kdTel input").val(),i=$("span.data-kdFax input").val(),n=new Object;n.eID="ajaxDispatcher",n.request={pluginName:"Glacrylshop",controller:"Aj",action:"editUser",arguments:{mail:e,tel:a,fax:i}};var r=API.ajax(!1,n,"GET","json");"false"==r.error&&($(this).removeClass("sprite-Bestaetigen accept-kontakt").addClass("sprite-Stift edit-kontakt"),$("span.data-kdMail").html(r.user.mail),$("span.data-kdTel").html(r.user.tel),$("span.data-kdFax").html(r.user.fax))},editKontaktBTNAction:function(t){t.preventDefault(),$(this).removeClass("sprite-Stift edit-kontakt").addClass("sprite-Bestaetigen accept-kontakt");var e=$(this).parent("legend").parent("fieldset").find("div span");e.each(function(t,e){var a=$(e).text();$(e).html('<input type="text" value="'+a+'" />')})}},Templates:{detail:function(t){var e="",a="";if(t.noError){var i=t.details,n=null,r=0;for(var s in i){if(t=i[s],""==e&&(e+="<p><b>Ihre Kommission:</b> "+t.noticeName+"</p>",e+="<p><b>Angelegt am:</b> "+t.create+"</p>",e+="<p><b>G&uuml;ltig bis:</b> "+t.expire+"</p>",n=t.details),a+="<tr>",a+='<td style="text-align:center;">'+t.position+"</td>",a+='<td style="text-align:center;">'+t.qty+"</td>",a+="<td>",a+=API.isset(t.article.schild)?t.article.schild.width+" x "+t.article.schild.height+" mm":API.isset(t.article.rahmen)?t.article.rahmen.width+" x "+t.article.rahmen.height+" mm":"&nbsp;",a+="</td>",a+='<td style="text-align:left;">',a+=API.isset(t.article.schild)?"<b>"+t.article.schild.material.name+" "+t.article.schild.size+" mm "+t.article.schild.material.variante+'</b><br /> <span class="notice-detail-materialInfo">inkl. Bearbeitung</span>':API.isset(t.article.product)?"<b>"+t.article.product.fixing.name+'</b><br /> <span class="notice-detail-materialInfo">'+t.article.product.fixing.vName+"</span>":API.isset(t.article.rahmen)?"<b>"+t.article.rahmen.profil.name+" "+t.article.rahmen.profil.variantenName+'</b><br /> <span class="notice-detail-materialInfo">inkl. Bearbeitung</span>':"&nbsp;",a+="</td>",a+='<td style="text-align:right;">'+API.priceView(t.price)+" &euro;</td>",r+=t.price*t.qty,a+='<td class="last" style="text-align:right;">'+API.priceView(t.price*t.qty)+" &euro;</td>",a+="</tr>",a+="<tr>",a+='<td class="cell-bottom-border last" style="border-top: none;" colspan="6">',a+='<div class="row">',a+='<div class="col-md-4" style="text-align:center;">',API.isset(t.article.schild)||API.isset(t.article.rahmen))a+='<img src="typo3conf/ext/glshop/Resources/Public/Zeichnungen/'+t.pic+'" />';else if(API.isset(t.article.product)){var l=t.article.product.fixing.bild.split(".");l=l[0]+"Mini.jpg",a+='<img style="width:210px; height:210px;" src="typo3conf/ext/glshop/Resources/Public/Img/Products/mini/'+l+'" />'}if(a+="</div>",a+='<div class="col-md-8 notice-detail">',console.log(t.article),API.isset(t.article.schild)){if(a+="<dl>",a+="<dt>Kantenbearbeitung:</dt>",a+="<dd><span><span><b>"+t.article.schild.edit.border.name+"</b></span></span></dd>",a+="</dl>",a+="<dl>",a+="<dt>Tempern:</dt>",a+="<dd><span><b>"+("false"==t.article.schild.edit.tempern?"Nein":"Ja")+"</b></span></dd>",a+="</dl>",API.isset(t.article.schild.edit.corner.length)&&t.article.schild.edit.corner.length>0){a+="<dl>",a+="<dt>Eckbearbeitung:</dt>";for(var d in t.article.schild.edit.corner){var o=t.article.schild.edit.corner[d];a+="<dd><span><b>Ecke:</b> "+o.corner+" - <b>"+o.name+"</b>,</span> <span>"+(""!=o.radius?"<b>Radius:</b> "+o.radius+" mm":"<b>X:</b> "+o.x+" mm <b>Y:</b> "+o.y+" mm")+"</span></dd>"}a+="</dl>"}if(API.isset(t.article.schild.edit.drill.length)&&t.article.schild.edit.drill.length>0){a+="<dl>",a+="<dt>Bohrungen:</dt>";for(var s in t.article.schild.edit.drill){var c=t.article.schild.edit.drill[s];a+="<dd><span><b>Ecke:</b> "+("FREI"==c.corner?"E4":c.corner)+",</span> <span><b>X:</b> "+c.x+" mm,</span> <span><b>Y:</b> "+c.y+" mm , <span><b>&Oslash;-Bohrung:</b> "+c.dB+" mm</span></dd>"}a+="</dl>"}if(API.isset(t.article.schild.edit.senkDrill.length)&&t.article.schild.edit.senkDrill.length>0){a+="<dl>",a+="<dt>Senkbohrungen:</dt>";for(var p in t.article.schild.edit.senkDrill){var h=t.article.schild.edit.senkDrill[p];a+="<dd><span><b>Ecke:</b> "+("FREI"==h.corner?"E4":h.corner)+", </span> <span><b>X:</b> "+h.x+" mm,</span> <span><b>Y:</b> "+h.y+" mm,</span> <span><b>&Oslash;-Bohrung:</b> "+API.dotToComma(h.dB)+" mm,</span> <span><b>&Oslash;-Senkung:</b> "+API.dotToComma(h.dS)+" mm</span></dd>"}a+="</dl>"}if(API.isset(t.article.schild.fixing.length)&&t.article.schild.fixing.length>0){a+="<dl>",a+="<dt>Befestigung:</dt>";var u=[];for(var m in t.article.schild.fixing){var b=t.article.schild.fixing[m];API.isset(u[b.artnr])?u[b.artnr].qty=u[b.artnr].qty+1:u[b.artnr]={qty:1,halter:b}}for(var m in u){var g=u[m];a+="<dd><span><b>"+g.qty+" St&uuml;ck "+g.halter.vName+"</b></span> <br/><span><b>Art.Nr.:</b> "+g.halter.artnr+"</span><br /></dd>"}a+="</dl>"}}else if(API.isset(t.article.product)){var g=t.article.product.fixing;a+="<dl>",a+="<dt>Befestigung:</dt>",a+="<dd>",a+="<span><b>Art.Nr.:</b> "+g.artnr+"</span><br />",a+="<span><b>Material:</b> "+g.material+"</span><br />",a+="<span><b>Wandabst.:</b> "+API.dotToComma(g.wa)+" mm</span><br />";var f="";f=1!=g.passing.sandwitch?-1==g.passing.von&&-1==g.passing.bis?"variabel":"von "+(-1==g.passing.von?"variabel":g.passing.von+" mm")+" bis "+(-1==g.passing.bis?"variabel":g.passing.bis+" mm"):"2 x "+g.passing.von+" mm",a+="<span><b>Passend f&uuml;r Materialst&auml;rken:</b> "+f+"</span><br />",a+="<span><b>Halterma&szlig;e:</b> "+("round"==g.size.form?"&Oslash;"+API.dotToComma(g.size.size)+" mm":API.dotToComma(g.size.size)+" x "+API.dotToComma(g.size.size)+" mm")+"</span><br />",a+="</dd>",a+="</dl>"}else API.isset(t.article.rahmen)&&(a+="<dl>",a+="<dt>Maße:</dt>",a+="<dd>",a+="<span><b>Gesamtau&szlig;enma&szlig;:</b> "+t.article.rahmen.width+" x "+t.article.rahmen.height+" mm</span><br/>",a+="<span><b>Sichtbereich:</b> "+(parseInt(t.article.rahmen.width)-26)+" x "+(parseInt(t.article.rahmen.height)-26)+" mm</span><br/>",a+="</dd>",a+="</dl>",API.isset(t.article.rahmen.frontscheibe.name)&&(a+="<dl>",a+="<dt>Frontscheibe:</dt>",a+="<dd>",a+="<span><b>Material:</b> "+t.article.rahmen.frontscheibe.name+" - "+t.article.rahmen.frontscheibe.variantenName+"</span><br/>",a+="<span><b>Sicherheitseigenschaften:</b> "+(1==t.article.rahmen.frontscheibe.variantenSicherheit?"Ja":"Nein")+"</span><br/>",a+="</dd>",a+="</dl>"),a+="<dl>",a+="<dt>Beleuchtung:</dt>",a+="<dd>",a+="<span><b>Lichtfarbe:</b> "+t.article.rahmen.led.name+"</span><br/>",a+="<span><b>Steuerung:</b> ",a+="weiß"==t.article.rahmen.led.name?" Farbe fest eingestellt - "+t.article.rahmen.led.variantenName:t.article.rahmen.led.variantenName,a+="</span><br/>",a+="<span><b>Verbaut in Rahmen:</b> ","true"==t.article.rahmen.kanten.K1&&(a+=" K1 "),"true"==t.article.rahmen.kanten.K2&&(a+=" K2 "),"true"==t.article.rahmen.kanten.K3&&(a+=" K3 "),"true"==t.article.rahmen.kanten.K4&&(a+=" K4 "),a+="</span><br/>",a+="</dd>",a+="</dl>",a+="<dl>",a+="<dt>Lichtstreuplatte:</dt>",a+="<dd>",a+="<span><b>Material:</b> "+t.article.rahmen.streuplatte.variantenName+"<br/> - "+t.article.rahmen.streuplatte.name+"</span><br/>",a+="</dd>",a+="</dl>",a+="<dl>",a+="<dt>Netzanschluss:</dt>",a+="<dd>",a+="<span><b>Einbausituation:</b> "+t.article.rahmen.anschluss.variantenName+"</span><br/>",a+="<span><b>Leuchtfeldausf&uuml;hrung:</b> "+t.article.rahmen.anschluss.variantenBeschreibung+"</span><br/>",a+="</dd>",a+="</dl>",a+="<dl>",a+="<dt>Befestigung:</dt>",a+="<dd>",a+="<span><b>Montageart:</b> "+t.article.rahmen.befestigung.name+"</span><br/>",a+="<span><b>Zubeh&ouml;r:</b> "+t.article.rahmen.befestigung.beschreibung+"</span><br/>",a+="<span><b>Vertiefung:</b> "+t.article.rahmen.befestigung.variantenName+"</span><br/>",a+="</dd>",a+="</dl>");a+="</div>",a+="</div>",a+="</td>",a+="</tr>"}var v=r,x="<tr>";x+='<td colspan="5" style="text-align:right;"><b>Zwischensumme</b></td>',x+='<td class="cell-bottom-border last" style="text-align:right;"><b>'+API.priceView(r)+" &euro;</b></td>",x+="</tr>",0!=n.rabatt&&(x+="<tr>",x+='<td colspan="5" style="text-align:right;">- Sondernachlass</td>',x+='<td class="cell-bottom-border last" style="text-align:right;">'+API.priceView(n.rabatt)+" &euro;</td>",v-=n.rabatt,x+="</tr>"),0!=n.ewPalette&&(x+="<tr>",x+='<td colspan="5" style="text-align:right;">+ Aufpreis für Einwegpalette</td>',x+='<td class="cell-bottom-border last" style="text-align:right;">'+API.priceView(n.ewPalette)+" &euro;</td>",v+=n.ewPalette,x+="</tr>"),(0!=n.rabatt||0!=n.ewPalette)&&(x+="<tr>",x+='<td colspan="5" style="text-align:right;"><b>Zwischensumme</b></td>',x+='<td  class="cell-bottom-border last" style="text-align:right;"><b>'+API.priceView(v)+" &euro;</b></td>",x+="</tr>"),x+="<tr>",x+='<td colspan="5" style="text-align:right;">+ MwSt (19%)</td>';var y=19*v/100;x+='<td class="cell-bottom-border last" style="text-align:right;">'+API.priceView(y)+" &euro;</td>",x+="</tr>",x+="<tr>",x+='<td class="cell-bottom-border" colspan="5" style="text-align:right;"><b>Summe</b></td>',x+='<td class="cell-bottom-border last" style="text-align:right;"><b>'+API.priceView(v+y)+" &euro;</b></td>",x+="</tr>",$("#notice-detail-header").html(e),$("#notice-detail-table tbody").html(a),$("#notice-detail-table tfoot").html(x)}}}}};$(function(){Konto.View.initializeFirst()})}(jQuery);