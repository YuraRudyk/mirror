!function($){function Adresse(e,t,s,n,a,r){this.uid=e,this.firma=t,this.person=s,this.strasse=n,this.plz=a,this.ort=r,this.getAdress=function(){return this}}var InputFieldTest={start:function(){var e=$(document).find("input[type=text]"),t=API.isDesktopTest();$.each(e,function(e,s){t?$(s).attr("type","text").attr("maxlength",4):$(s).attr("type","number").removeAttr("maxlength")})}},API={usedIds:new Array,isMobile:window.matchMedia("only screen and (max-width: 750px)").matches,isTablet:window.matchMedia("only screen and (max-width: 974px)").matches,isDesktop:window.matchMedia("only screen and (min-width: 975px)").matches,isMobileTest:function(){var e=parseInt($(window).width());return 750>=e?!0:!1},isTabletTest:function(){var e=parseInt($(window).width());return 974>=e?!0:!1},isDesktopTest:function(){var e=parseInt($(window).width());return e>=975?!0:!1},createRandomNumber:function(){var e=Math.floor(10002*Math.random()+1);return-1==$.inArray(e,this.usedIds)?(this.usedIds.push(e),e):this.createRandomNumber()},ajax:function(async,data,type,dataType,sMsg,eMsg){var res=$.ajax({url:"index.php",async:async,global:!1,data:data,type:type,dataType:dataType,success:function(){null!=sMsg&&alert(sMsg)},error:function(){null!=eMsg&&alert(eMsg)}}).responseText;return"json"==dataType&&""!=res&&null!=res&&res.length>0&&(res=eval("("+res+")")),res},dotToComma:function(e){return e+="",e=e.replace(".",",")},commaToDot:function(e){return e+="",e=e.replace(".",""),e=e.replace(",",".")},round:function(e,t){if(1>t||t>14)return!1;var s=Math.pow(10,t),n=(Math.round(e*s)/s).toString();return-1==n.indexOf(".")&&(n+="."),n+=s.toString().substring(1),n.substring(0,n.indexOf(".")+t+1)},priceView:function(e){function t(e,t,a){t||(t=0);var r="",i=0>e?"-":"",o=Math.pow(10,t),l=Math.abs(e);l=""+parseInt(l*o+.5)/o;var d=l.indexOf(".");for(a&&t&&(l+=(-1==d?".":"")+o.toString().substring(1)),d=l.indexOf("."),-1==d?d=l.length:r=s+l.substr(d+1,t);d>0;)r=d-3>0?n+l.substring(d-3,d)+r:l.substring(0,d)+r,d-=3;return i+r}var s=",",n=".";return t(e,2,!0)},isset:function(e){return"undefined"!=typeof e&&null!=e?!0:!1}},View={actions:{initializeFirst:function(){this.Cart.initialize(),$("#add-Notice-Dialog").dialog({autoOpen:!1,resizable:!1,height:"auto",modal:!0,buttons:{Ja:function(){$(this).dialog("close");var e=$("base").attr("href"),t=e+"shop/?tx_glshop_glacrylshop%5Baction%5D=clearCart&tx_glshop_glacrylshop%5Bcontroller%5D=Cart";window.location=t},Nein:function(){$(this).dialog("close")}}}),0!=$(".cart-change-qty").length&&$(window).resize(function(){InputFieldTest.start()})},setNewShippigPrices:function(e){var t={eID:"ajaxDispatcher",request:{pluginName:"Flgkonfigurator",controller:"Aj",action:"getNewShippingPrice",arguments:{zip:e}}},s=API.ajax(!1,t,"POST","json");$("#kasse-standardversand-preis").val(s.standard).prev("label").find("span").find("span").html(API.priceView(s.standard)),$("#kasse-expressversand-preis").val(s.express).prev("label").find("span").find("span").html(API.priceView(s.express)),View.actions.Cart.calculateDeliveryFunction()},Cart:{initialize:function(){$("body").on("click",".cart-menue li a",View.actions.Cart.clickOnMenueItemFunction),$("body").on("click",".cartItem-DetailBtn",View.actions.Cart.showDetailFunction),$("body").on("click",'input[name="kasse-versand"]',View.actions.Cart.calculateDeliveryFunction),$("body").on("click","#kasse-bestellenBtn",View.actions.Cart.orderFunction),$("body").on("click",".selectDifferentShippingBtn",View.actions.Cart.selectDifferentAdressFuntion),$("body").on("click","#different-adress-select",View.actions.Cart.selectShippingAdressFuntion),$("body").on("click","#save-differentAdressBtn",View.actions.Cart.saveDifferentAdressFunction),$("body").on("click","#abbr-differentAdressBtn",View.actions.Cart.cancelDifferentAdressFunction),$("body").on("click","#choose-differentAdressBtn",View.actions.Cart.chooseDifferentAdressFunction),$("body").on("click","#addVoucher",View.actions.Cart.addVoucherFunction),$("body").on("click","#addToNoticeList",View.actions.Cart.addToNoticeListFunction),$("body").on("click","#back-to-Top-Lnk",View.actions.Cart.backToTopFunction)},addVoucherFunction:function(e){$("#cart-voucherCode").val()},addToNoticeListFunction:function(e){var t=$("#cart-noticeName").val(),s=new Object;s.eID="ajaxDispatcher",s.request={pluginName:"Flgkonfigurator",controller:"Aj",action:"createNoticeList",arguments:{name:t}};API.ajax(!1,s,"POST","json");$("#add-Notice-Dialog").dialog("open")},clickOnMenueItemFunction:function(e){API.isset($(".cart-panel").html())&&"Es liegen zur Zeit keine Produkte im Warenkorb!"==$(".cart-panel").html().trim("")&&e.preventDefault()},backToTopFunction:function(e){e.preventDefault();var t=$(this).attr("href");$("html, body").animate({scrollTop:$(t).offset().top},"slow")},cancelDifferentAdressFunction:function(e){e.preventDefault(),$("#kasse-shipping-adress").show(),$("#kasse-different-adress").hide()},deletePositionFromCartFunction:function(e){e.preventDefault();var t=$(this).attr("value");$(this).parent("form").find("input.positionAction").val(t),$(this).parent("form").submit()},updateCartPositionFunction:function(e){e.preventDefault();var t=$(this).attr("value");$(this).parent("form").find("input.positionAction").val(t),$(this).parent("form").submit()},orderFunction:function(e){e.preventDefault();var t=$("#kasse-kommission").val(),s=$("#kasse-nachricht").val(),n="rechnung";Cart.setZahlung(n),Cart.setKommission(t),Cart.setBemerkung(s);var a=new Object;a.eID="ajaxDispatcher",a.request={pluginName:"Flgkonfigurator",controller:"Aj",action:"placeOrder",arguments:{data:Cart.getData()}};var r=API.ajax(!1,a,"POST","json");1==r.error?($(".kasse-success").show(),$(".kasse-maske").hide()):($(".kasse-success").hide(),$(".kasse-maske").show())},chooseDifferentAdressFunction:function(e){e.preventDefault;var t=$("#different-adress-select").val(),s=null;"eigene"==t?(Cart.resetLieferAdresse(),s=Cart.getOriginalAdress()):(Cart.setLieferAdresse(t),s=Cart.getAdress(t)),$("#kasse-shipping-company b").html(s.firma),$("#kasse-shipping-person").html(s.person),$("#kasse-shipping-street").html(s.strasse),$("#kasse-shipping-zip").html(s.plz),$("#kasse-shipping-city").html(s.ort),$("#kasse-shipping-adress").show(),$("#kasse-different-adress").hide(),View.actions.setNewShippigPrices(s.plz)},saveDifferentAdressFunction:function(e){e.preventDefault();var t=$("#different-firma").val(),s=$("#different-person").val(),n=$("#different-str").val(),a=$("#different-plz").val(),r=$("#different-ort").val(),i={eID:"ajaxDispatcher",request:{pluginName:"Flgkonfigurator",controller:"Aj",action:"saveLieferAdresse",arguments:{abwFirma:t,abwPerson:s,abwStrasse:n,abwPlz:a,abwOrt:r}}},o=API.ajax(!1,i,"POST","json"),l=new Adresse(o.uid,o.company,o.person,o.street,o.zip,o.city);Cart.adressen.push(l),$("#different-adress-select").append('<option value="'+o.uid+'" title="'+o.person+'">'+(""==o.company?o.person:o.company)+"</option>"),Cart.setLieferAdresse(o.uid),$("#kasse-shipping-company b").html(l.firma),$("#kasse-shipping-person").html(l.person),$("#kasse-shipping-street").html(l.strasse),$("#kasse-shipping-zip").html(l.plz),$("#kasse-shipping-city").html(l.ort),$("#kasse-shipping-adress").show(),$("#kasse-different-adress").hide(),View.actions.setNewShippigPrices(l.plz)},selectShippingAdressFuntion:function(e){e.preventDefault;var t=$(this).val();if("none"==t)$("#choose-differentAdressBtn").attr("style","display:none;"),$("#save-differentAdressBtn").attr("style","display:inline-block;"),$("#different-firma").val("").removeAttr("readonly"),$("#different-person").val("").removeAttr("readonly"),$("#different-str").val("").removeAttr("readonly"),$("#different-plz").val("").removeAttr("readonly"),$("#different-ort").val("").removeAttr("readonly");else if("eigene"==t){$("#choose-differentAdressBtn").attr("style","display:inline-block;"),$("#save-differentAdressBtn").attr("style","display:none;");var s=Cart.getOriginalAdress();$("#different-firma").val(s.firma).attr("readonly","readonly"),$("#different-person").val(s.person).attr("readonly","readonly"),$("#different-str").val(s.strasse).attr("readonly","readonly"),$("#different-plz").val(s.plz).attr("readonly","readonly"),$("#different-ort").val(s.ort).attr("readonly","readonly")}else{$("#choose-differentAdressBtn").attr("style","display:inline-block;"),$("#save-differentAdressBtn").attr("style","display:none;");for(var n=Cart.getAdressen(),a=0;a<n.length;a++)Number(n[a].uid)==Number(t)&&($("#different-firma").val(n[a].firma).attr("readonly","readonly"),$("#different-person").val(n[a].person).attr("readonly","readonly"),$("#different-str").val(n[a].strasse).attr("readonly","readonly"),$("#different-plz").val(n[a].plz).attr("readonly","readonly"),$("#different-ort").val(n[a].ort).attr("readonly","readonly"))}},selectDifferentAdressFuntion:function(e){e.preventDefault,$("#kasse-shipping-adress").hide(),$("#kasse-different-adress").show()},calculateDeliveryFunction:function(e){var t=$(this).attr("id"),s=0,n=0,a=0,r=0,i=0;switch(r="undefined"!=typeof $("#kasse-zwischen span").html()?parseFloat(API.commaToDot($("#kasse-zwischen span").html())):parseFloat(API.commaToDot($("#kasse-netto span").html())),t){case"kasse-versand-abholung":i=r+s,n=.19*(r+s),a=r+s+n,$("#kasse-versand span").html(API.priceView(s)),$("#kasse-zwischenSumme b span").html(API.priceView(i)),$("#kasse-mwst span").html(API.priceView(n)),$("#kasse-brutto b span").html(API.priceView(a)),Cart.setVersand("abholung",0);break;case"kasse-versand-standard":s=parseFloat($("#kasse-standardversand-preis").val()),i=r+s,n=.19*(r+s),a=r+s+n,$("#kasse-versand span").html(API.priceView(s)),$("#kasse-zwischenSumme b span").html(API.priceView(i)),$("#kasse-mwst span").html(API.priceView(n)),$("#kasse-brutto b span").html(API.priceView(a)),Cart.setVersand("standard",API.round(s,2));break;case"kasse-versand-express":s=parseFloat($("#kasse-expressversand-preis").val()),i=r+s,n=.19*(r+s),a=r+s+n,$("#kasse-versand span").html(API.priceView(s)),$("#kasse-zwischenSumme b span").html(API.priceView(i)),$("#kasse-mwst span").html(API.priceView(n)),$("#kasse-brutto b span").html(API.priceView(a)),Cart.setVersand("express",API.round(s,2))}},showDetailFunction:function(e){e.preventDefault();var t=$(this).parents("tr")[0],s=$(t).next("tr");s.is(":visible")?$(t).find("td").each(function(){$(this).addClass("cell-bottom-border"),s.find("td").each(function(){$(this).removeClass("cell-bottom-border")})}):$(t).find("td").each(function(){$(this).removeClass("cell-bottom-border"),s.find("td").each(function(){$(this).addClass("cell-bottom-border")})}),s.toggle()}}}},Cart={adressen:[],userData:null,order:null,originalAdress:{person:"",firma:"",strasse:"",plz:"",ort:""},data:{adresse:{rechnung:null,lieferung:null},bemerkung:{kommission:null,bemerkung:null},versand:{art:null,preis:null},zahlung:{art:null}},getData:function(){return this.data},setVersand:function(e,t){this.data.versand.art=e,this.data.versand.preis=t},setZahlung:function(e){this.data.zahlung.art=e},setKommission:function(e){this.data.bemerkung.kommission=e},setBemerkung:function(e){this.data.bemerkung.bemerkung=e},setLieferAdresse:function(e){this.data.adresse.lieferung=e},resetLieferAdresse:function(){this.data.adresse.lieferung=null},initialize:function(){this.setOrder(),this.setUserData(),this.setAdressen(),this.setOriginalAdress()},setOrder:function(){var e=new Object;e.eID="ajaxDispatcher",e.request={pluginName:"Glacrylshop",controller:"Aj",action:"getCart",arguments:{uid:""}}},setOriginalAdress:function(){this.originalAdress.person=$("#kasse-shipping-adress").find("input[name=person]").val(),this.originalAdress.firma=$("#kasse-shipping-adress").find("input[name=firma]").val(),this.originalAdress.strasse=$("#kasse-shipping-adress").find("input[name=adress]").val(),this.originalAdress.plz=$("#kasse-shipping-adress").find("input[name=zip]").val(),this.originalAdress.ort=$("#kasse-shipping-adress").find("input[name=city]").val()},getOriginalAdress:function(){return this.originalAdress},setUserData:function(){var e=new Object;e.eID="ajaxDispatcher",e.request={pluginName:"Glacrylshop",controller:"Aj",action:"userAdress",arguments:{uid:""}};var t=API.ajax(!1,e,"GET","json");this.userData=t},getUserData:function(){return this.userData},setAdressen:function(){var e=new Object;e.eID="ajaxDispatcher",e.request={pluginName:"Glacrylshop",controller:"Aj",action:"userAdress",arguments:{uid:""}};for(var t=API.ajax(!1,e,"GET","json"),s=0;s<t.length;s++){var n=new Adresse(t[s].uid,t[s].company,t[s].person,t[s].street,t[s].zip,t[s].city);this.adressen.push(n)}},getAdress:function(e){for(var t=0;t<this.adressen.length;t++)if(this.adressen[t].uid==e)return this.adressen[t]},getAdressen:function(){return this.adressen}};$(function(){View.actions.initializeFirst(),Cart.initialize()})}(jQuery);