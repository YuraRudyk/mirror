{namespace femanager=In2code\Femanager\ViewHelpers}
{namespace v=FluidTYPO3\Vhs\ViewHelpers}

<f:layout name="Default" />

	User / New
		Available variables:
			{user}
			{allUserGroups}

<f:section name="main">


	<f:if condition="{settings.new.validation._enable.client} == 1">
	<f:then>
		<v:asset.script path="files/js/Validation.js" name="femanagerValidation" external="0" movable="1" fluid="0" rewrite="0" overwrite="0" standalone="1" />
		<v:asset.script path="typo3conf/ext/femanager/Resources/Public/JavaScripts/Femanager.js" name="femanager" external="0" movable="1" fluid="0" rewrite="0" overwrite="0" standalone="1" />
	</f:then>
	<f:else>
		<v:asset.script path="files/js/emailValidation.js" name="femanagerValidation" external="0" movable="1" fluid="0" rewrite="0" overwrite="0" standalone="1" />
	</f:else>
	</f:if>

	<f:switch expression="{v:content.info(field: 'layout')}">
		<f:case value="1">
			{settings.new.action -> v:variable.set(name: 'externalUrl')}
		</f:case>
		<f:case default="TRUE">
			<script>
				var ajaxUrl = '<f:uri.action action="searchEmail" controller="Ajax" pluginName="Pi1" extensionName="T3webSite" pageType="123" />';
				var forgotPasswordPage = '<f:uri.page pageUid="{settings.forgotPassword}" />';
			</script>
		</f:case>
	</f:switch>

	<ul class="messages-container">
		<f:render partial="Misc/FlashMessages" arguments="{_all}" />
		<f:render partial="Misc/FormErrors" arguments="{object:User}" />
	</ul>
	<div class="femanager_new">

		<f:form name="user" object="{user}" action="create" actionUri="{externalUrl.value}" id="registration_form" class="row contact_form form-horizontal {f:if(condition:'{settings.new.validation._enable.client}',then:'feManagerValidation',else:'')} layout-{v:content.info(field: 'layout')}" additionalAttributes="{novalidate:'novalidate'}">
			<f:if condition="{v:content.info(field: 'layout')} == 1">
				<f:form.hidden name="danke" value="{f:uri.page(pageUid:settings.newUserDank, absolute:'1')}" />
			</f:if>
				<f:if condition="{settings.new.fields}">
					<f:then>
						<f:comment>
							If some fields are selected in the flexform
						</f:comment>
						<f:for each="{femanager:misc.explode(string:'{settings.new.fields}')}" as="field">
							<f:render partial="Fields/{femanager:misc.upper(string:'{field}')}" arguments="{_all}" />
						</f:for>
						<f:render partial="Fields/SubmitCreate" arguments="{_all}" />
					</f:then>

					<f:else>
						<f:comment>
							If no fields are selected in the flexform => show all
						</f:comment>
						<f:render partial="Fields/Username" arguments="{_all}" />
						<f:render partial="Fields/Password" arguments="{_all}" />
						<f:render partial="Fields/Title" arguments="{_all}" />
						<f:render partial="Fields/Name" arguments="{_all}" />
						<f:render partial="Fields/FirstName" arguments="{_all}" />
						<f:render partial="Fields/MiddleName" arguments="{_all}" />
						<f:render partial="Fields/LastName" arguments="{_all}" />
						<f:render partial="Fields/Gender" arguments="{_all}" />
						<f:render partial="Fields/DateOfBirth" arguments="{_all}" />
						<f:render partial="Fields/Company" arguments="{_all}" />
						<f:render partial="Fields/Www" arguments="{_all}" />
						<f:render partial="Fields/Email" arguments="{_all}" />
						<f:render partial="Fields/Telephone" arguments="{_all}" />
						<f:render partial="Fields/Fax" arguments="{_all}" />
						<f:render partial="Fields/Address" arguments="{_all}" />
						<f:render partial="Fields/Zip" arguments="{_all}" />
						<f:render partial="Fields/City" arguments="{_all}" />
						<f:render partial="Fields/Country" arguments="{_all}" />
						<f:render partial="Fields/Image" arguments="{_all}" />
						<f:render partial="Fields/Usergroup" arguments="{_all}" />
						<f:if condition="{femanager:Misc.CaptchaEnabled(settings:'{settings}')}">
							<f:render partial="Fields/Captcha" arguments="{_all}" />
						</f:if>

						<f:render partial="Fields/SubmitCreate" arguments="{_all}" />
					</f:else>

				</f:if>


		</f:form>
	</div>
</f:section>
